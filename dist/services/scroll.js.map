{"version":3,"sources":["../../src/services/scroll.js"],"names":["Scroll","window","pageYOffset","pageXOffset","debounced","trigger","props","requestAnimationFrame","handler","bind","document","addEventListener","passive","removeEventListener","yLast","y","xLast","x","yProgress","max","xProgress","changed","last","delta","progress","scrollingElement","body","scrollWidth","innerWidth","scrollHeight","innerHeight","Service","scroll","add","remove"],"mappings":"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","sourcesContent":["import Service from '../abstracts/Service';\nimport throttle from '../utils/throttle';\nimport debounce from '../utils/debounce';\n\n/**\n * Scroll service\n *\n * ```\n * import { useScroll } from '@studiometa/js-toolkit/services';\n * const { add, remove, props } = useScroll();\n * add(key, (props) => {});\n * remove(key);\n * props();\n * ```\n */\nclass Scroll extends Service {\n  /** @type {Number} The y scroll position. */\n  y = window.pageYOffset;\n\n  /** @type {Number} The y previous scroll position. */\n  yLast = window.pageYOffset;\n\n  /** @type {Number} The x scroll position. */\n  x = window.pageXOffset;\n\n  /** @type {Number} The x previous scroll position. */\n  xLast = window.pageXOffset;\n\n  /**\n   * Bind the handler to the scroll event.\n   *\n   * @return {void}\n   */\n  init() {\n    const debounced = debounce(() => {\n      this.trigger(this.props);\n      requestAnimationFrame(() => {\n        this.trigger(this.props);\n      });\n    }, 50);\n\n    this.handler = throttle(() => {\n      this.trigger(this.props);\n\n      // Reset changed flags at the end of the scroll event\n      debounced();\n    }, 32).bind(this);\n\n    // Fire the `scrolled` method on document scroll\n    document.addEventListener('scroll', this.handler, { passive: true });\n  }\n\n  /**\n   * Unbind the handler from the scroll event.\n   *\n   * @return {void}\n   */\n  kill() {\n    document.removeEventListener('scroll', this.handler);\n  }\n\n  /**\n   * Get scroll props.\n   *\n   * @type {Object}\n   */\n  get props() {\n    this.yLast = this.y;\n    this.xLast = this.x;\n\n    // Check scroll Y\n    if (window.pageYOffset !== this.y) {\n      this.y = window.pageYOffset;\n      this.yProgress = this.y / this.max.y;\n    }\n\n    // Check scroll x\n    if (window.pageXOffset !== this.x) {\n      this.x = window.pageXOffset;\n      this.xProgress = this.x / this.max.x;\n    }\n\n    return {\n      x: this.x,\n      y: this.y,\n      changed: {\n        x: this.x !== this.xLast,\n        y: this.y !== this.yLast,\n      },\n      last: {\n        x: this.xLast,\n        y: this.yLast,\n      },\n      delta: {\n        x: this.x - this.xLast,\n        y: this.y - this.yLast,\n      },\n      progress: {\n        x: this.xProgress,\n        y: this.yProgress,\n      },\n      max: this.max,\n    };\n  }\n\n  /**\n   * Get scroll max values.\n   *\n   * @type {Object}\n   */\n  get max() {\n    return {\n      x: (document.scrollingElement || document.body).scrollWidth - window.innerWidth,\n      y: (document.scrollingElement || document.body).scrollHeight - window.innerHeight,\n    };\n  }\n}\n\nlet scroll = null;\n\nexport default () => {\n  if (!scroll) {\n    scroll = new Scroll();\n  }\n\n  const add = scroll.add.bind(scroll);\n  const remove = scroll.remove.bind(scroll);\n  const props = () => scroll.props;\n\n  return {\n    add,\n    remove,\n    props,\n  };\n};\n"],"file":"scroll.js"}