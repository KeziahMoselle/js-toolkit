{"version":3,"sources":["../../src/services/scroll.js"],"names":["Scroll","window","pageYOffset","pageXOffset","debounced","trigger","props","handler","bind","document","addEventListener","passive","removeEventLisetner","yLast","y","xLast","x","yProgress","max","xProgress","changed","last","delta","progress","scrollingElement","body","scrollWidth","innerWidth","scrollHeight","innerHeight","Service","scroll","add","remove"],"mappings":"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","sourcesContent":["import Service from '../abstracts/Service';\nimport { throttle, debounce } from '../utils';\n\n/**\n * Scroll service\n *\n * ```\n * import { useScroll } from '@studiometa/js-toolkit/services';\n * const { add, remove, props } = useScroll();\n * add(key, callback);\n * remove(key);\n * props();\n * ```\n */\nclass Scroll extends Service {\n  /** @type {Number} The y scroll position. */\n  y = window.pageYOffset;\n\n  /** @type {Number} The y previous scroll position. */\n  yLast = window.pageYOffset;\n\n  /** @type {Number} The x scroll position. */\n  x = window.pageXOffset;\n\n  /** @type {Number} The x previous scroll position. */\n  xLast = window.pageXOffset;\n\n  /**\n   * Bind the handler to the scroll event.\n   *\n   * @return {void}\n   */\n  init() {\n    const debounced = debounce(() => {\n      this.trigger(this.props);\n    }, 50);\n\n    this.handler = throttle(() => {\n      this.trigger(this.props);\n\n      // Reset changed flags at the end of the scroll event\n      debounced();\n    }, 32).bind(this);\n\n    // Fire the `scrolled` method on document scroll\n    document.addEventListener('scroll', this.handler, { passive: true });\n  }\n\n  /**\n   * Unbind the handler from the scroll event.\n   *\n   * @return {void}\n   */\n  kill() {\n    document.removeEventLisetner('scroll', this.handler);\n  }\n\n  /**\n   * Get scroll props.\n   *\n   * @type {Object}\n   */\n  get props() {\n    this.yLast = this.y;\n    this.xLast = this.x;\n\n    // Check scroll Y\n    if (window.pageYOffset !== this.y) {\n      this.y = window.pageYOffset;\n      this.yProgress = this.y / this.max.y;\n    }\n\n    // Check scroll x\n    if (window.pageXOffset !== this.x) {\n      this.x = window.pageXOffset;\n      this.xProgress = this.x / this.max.x;\n    }\n\n    return {\n      x: this.x,\n      y: this.y,\n      changed: {\n        x: this.x !== this.xLast,\n        y: this.y !== this.yLast,\n      },\n      last: {\n        x: this.xLast,\n        y: this.yLast,\n      },\n      delta: {\n        x: this.x - this.xLast,\n        y: this.y - this.yLast,\n      },\n      progress: {\n        x: this.xProgress,\n        y: this.yProgress,\n      },\n      max: this.max,\n    };\n  }\n\n  /**\n   * Get scroll max values.\n   *\n   * @type {Object}\n   */\n  get max() {\n    return {\n      x: (document.scrollingElement || document.body).scrollWidth - window.innerWidth,\n      y: (document.scrollingElement || document.body).scrollHeight - window.innerHeight,\n    };\n  }\n}\n\nconst scroll = new Scroll();\nconst add = scroll.add.bind(scroll);\nconst remove = scroll.remove.bind(scroll);\nconst props = () => scroll.props;\n\nexport default () => ({\n  add,\n  remove,\n  props,\n});\n"],"file":"scroll.js"}