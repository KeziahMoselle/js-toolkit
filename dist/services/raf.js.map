{"version":3,"sources":["../../src/services/raf.js"],"names":["Raf","loop","trigger","props","isTicking","requestAnimationFrame","time","window","performance","now","Service","raf","add","bind","remove"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAEA;;;;;;;;;;;IAWMA,G;;;;;;;;;;;;;;;kGAEQ,K;;;;;;;AAEZ;;;;;2BAKO;AAAA;;AACL,UAAMC,IAAI,GAAG,SAAPA,IAAO,GAAM;AACjB,QAAA,MAAI,CAACC,OAAL,CAAa,MAAI,CAACC,KAAlB;;AAEA,YAAI,CAAC,MAAI,CAACC,SAAV,EAAqB;AACnB;AACD;;AAEDC,QAAAA,qBAAqB,CAACJ,IAAD,CAArB;AACD,OARD;;AAUA,WAAKG,SAAL,GAAiB,IAAjB;AACAH,MAAAA,IAAI;AACL;AAED;;;;;;;;2BAKO;AACL,WAAKG,SAAL,GAAiB,KAAjB;AACD;AAED;;;;;;;;;wBAMY;AACV,aAAO;AACLE,QAAAA,IAAI,EAAEC,MAAM,CAACC,WAAP,CAAmBC,GAAnB;AADD,OAAP;AAGD;;;EA3CeC,oB;;AA8ClB,IAAIC,GAAG,GAAG,IAAV;;eAEe,oBAAM;AACnB,MAAI,CAACA,GAAL,EAAU;AACRA,IAAAA,GAAG,GAAG,IAAIX,GAAJ,EAAN;AACD;;AAED,MAAMY,GAAG,GAAGD,GAAG,CAACC,GAAJ,CAAQC,IAAR,CAAaF,GAAb,CAAZ;AACA,MAAMG,MAAM,GAAGH,GAAG,CAACG,MAAJ,CAAWD,IAAX,CAAgBF,GAAhB,CAAf;;AACA,MAAMR,KAAK,GAAG,SAARA,KAAQ;AAAA,WAAMQ,GAAG,CAACR,KAAV;AAAA,GAAd;;AAEA,SAAO;AACLS,IAAAA,GAAG,EAAHA,GADK;AAELE,IAAAA,MAAM,EAANA,MAFK;AAGLX,IAAAA,KAAK,EAALA;AAHK,GAAP;AAKD,C","sourcesContent":["import Service from '../abstracts/Service';\n\n/**\n * Tick service\n *\n * ```\n * import { useRaf } from '@studiometa/js/services';\n * const { add, remove, props } = useRag();\n * add(id, (props) => {});\n * remove(id);\n * props();\n * ```\n */\nclass Raf extends Service {\n  /** @type {Boolean} Whether the loop is running or not. */\n  isTicking = false;\n\n  /**\n   * Start the requestAnimationFrame loop.\n   *\n   * @return {void}\n   */\n  init() {\n    const loop = () => {\n      this.trigger(this.props);\n\n      if (!this.isTicking) {\n        return;\n      }\n\n      requestAnimationFrame(loop);\n    };\n\n    this.isTicking = true;\n    loop();\n  }\n\n  /**\n   * Stop the requestAnimationFrame loop.\n   *\n   * @return {void}\n   */\n  kill() {\n    this.isTicking = false;\n  }\n\n  /**\n   * Get raf props.\n   *\n   * @todo Return elapsed time / index?\n   * @type {Object}\n   */\n  get props() {\n    return {\n      time: window.performance.now(),\n    };\n  }\n}\n\nlet raf = null;\n\nexport default () => {\n  if (!raf) {\n    raf = new Raf();\n  }\n\n  const add = raf.add.bind(raf);\n  const remove = raf.remove.bind(raf);\n  const props = () => raf.props;\n\n  return {\n    add,\n    remove,\n    props,\n  };\n};\n"],"file":"raf.js"}