{"version":3,"sources":["../../../src/utils/css/transition.js"],"names":["nextFrame","classes","styles","setClassesOrStyles","element","classesOrStyles","method","testTransition","window","getComputedStyle","transitionDuration","start","__isTransitioning__","from","active","next","hasTransition","Promise","resolve","__transitionEndHandler__","addEventListener","to","end","mode","removeEventListener","transition","name","endMode"],"mappings":"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","sourcesContent":["/* eslint no-underscore-dangle: [\"error\", { \"allow\": [\"__isTransitioning__\", \"__transitionEndHandler__\"] }] */\nimport nextFrame from '../nextFrame';\nimport * as classes from './classes';\nimport * as styles from './styles';\n\n/**\n * Update either the classes or the styles of an element with the given method.\n *\n * @param {HTMLElement}   element         The element to update.\n * @param {String|Object} classesOrStyles The classes or styles to apply.\n * @param {String}        method          The method to use, one of `add` or `remove`.\n */\nexport function setClassesOrStyles(element, classesOrStyles, method = 'add') {\n  if (typeof classesOrStyles === 'string') {\n    classes[method](element, classesOrStyles, method);\n  } else {\n    styles[method](element, classesOrStyles, method);\n  }\n}\n\n/**\n * Test if the given element has a transition duration.\n *\n * @param  {HTMLElement} element The element to test.\n * @return {Boolean}             The result of the test.\n */\nfunction testTransition(element) {\n  if (typeof window === 'undefined') {\n    return false;\n  }\n\n  const { transitionDuration } = window.getComputedStyle(element);\n  return !!transitionDuration && transitionDuration !== '0s';\n}\n\n/**\n * Apply the from state.\n *\n * @param {HTMLElement}   element         The target element.\n * @param {String|Object} classesOrStyles The classes or styles definition.\n * @return {Promise}\n */\nasync function start(element, classesOrStyles) {\n  element.__isTransitioning__ = true;\n  setClassesOrStyles(element, classesOrStyles.from);\n  await nextFrame();\n  setClassesOrStyles(element, classesOrStyles.active);\n  await nextFrame();\n}\n\n/**\n * Apply the active state.\n *\n * @param {HTMLElement}   element         The target element.\n * @param {String|Object} classesOrStyles The classes or styles definition.\n * @return {Promise}\n */\nasync function next(element, classesOrStyles) {\n  const hasTransition = testTransition(element);\n\n  /* eslint-disable-next-line */\n  return new Promise(async resolve => {\n    if (hasTransition) {\n      element.__transitionEndHandler__ = resolve;\n      element.addEventListener('transitionend', element.__transitionEndHandler__, false);\n    }\n    setClassesOrStyles(element, classesOrStyles.from, 'remove');\n    setClassesOrStyles(element, classesOrStyles.to);\n    await nextFrame();\n    if (!hasTransition) {\n      resolve();\n    }\n  });\n}\n\n/**\n * Apply the final state.\n *\n * @param {HTMLElement}   element         The target element.\n * @param {String|Object} classesOrStyles The classes or styles definition.\n * @param {String}        mode            Whether to remove or keep the `to`  classes/styles.\n * @return {void}\n */\nfunction end(element, classesOrStyles, mode = 'remove') {\n  element.removeEventListener('transitionend', element.__transitionEndHandler__, false);\n  if (mode === 'remove') {\n    setClassesOrStyles(element, classesOrStyles.to, 'remove');\n  }\n  setClassesOrStyles(element, classesOrStyles.active, 'remove');\n  delete element.__isTransitioning__;\n  delete element.__transitionEndHandler__;\n}\n\n/**\n * Manage CSS transition with class.\n *\n * This is heavily inspired by the Vue `<transition>` component\n * and the `@barba/css` package, many thanks to them!\n *\n * @param  {HTMLElement}   element The target element.\n * @param  {String|Object} name    The name of the transition or an object with the hooks classesOrStyles.\n * @param  {String}        endMode    Whether to remove or keep the `to` classes/styles\n * @return {Promise}               A promise resolving at the end of the transition.\n */\nexport default async function transition(element, name, endMode = 'remove') {\n  const classesOrStyles =\n    typeof name === 'string'\n      ? {\n          from: `${name}-from`,\n          active: `${name}-active`,\n          to: `${name}-to`,\n        }\n      : {\n          from: '',\n          active: '',\n          to: '',\n          ...name,\n        };\n\n  // End any previous transition running on the element.\n  if (element.__isTransitioning__) {\n    end(element, classesOrStyles);\n  }\n\n  await start(element, classesOrStyles);\n  await next(element, classesOrStyles);\n  end(element, classesOrStyles, endMode);\n  return Promise.resolve();\n}\n"],"file":"transition.js"}