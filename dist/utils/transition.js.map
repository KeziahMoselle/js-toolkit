{"version":3,"sources":["../../src/utils/transition.js"],"names":["setClassesOrStyles","element","classesOrStyles","method","testTransition","window","getComputedStyle","transitionDuration","start","classes","__isTransitioning__","from","active","next","hasTransition","Promise","resolve","__transitionEndHandler__","addEventListener","to","end","removeEventListener","transition","name"],"mappings":"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","sourcesContent":["/* eslint no-underscore-dangle: [\"error\", { \"allow\": [\"__isTransitioning__\", \"__transitionEndHandler__\"] }] */\nimport nextFrame from './nextFrame';\nimport setClasses from './setClasses';\nimport setStyles from './setStyles';\n\n/**\n * Update either the classes or the styles of an element with the given method.\n *\n * @param {HTMLElement}   element         The element to update.\n * @param {String|Object} classesOrStyles The classes or styles to apply.\n * @param {String}        method          The method to use, one of `add` or `remove`.\n */\nfunction setClassesOrStyles(element, classesOrStyles, method = 'add') {\n  if (typeof classesOrStyles === 'string') {\n    setClasses(element, classesOrStyles, method);\n  } else {\n    setStyles(element, classesOrStyles, method);\n  }\n}\n\n/**\n * Test if the given element has a transition duration.\n *\n * @param  {HTMLElement} element The element to test.\n * @return {Boolean}             The result of the test.\n */\nfunction testTransition(element) {\n  if (typeof window === 'undefined') {\n    return false;\n  }\n\n  const { transitionDuration } = window.getComputedStyle(element);\n  return !!transitionDuration && transitionDuration !== '0s';\n}\n\n/**\n * Apply the from state.\n *\n * @return {Promise}\n */\nasync function start(element, classes) {\n  element.__isTransitioning__ = true;\n  setClassesOrStyles(element, classes.from);\n  await nextFrame();\n  setClassesOrStyles(element, classes.active);\n  await nextFrame();\n}\n\n/**\n * Apply the active state.\n *\n * @return {Promise}\n */\nasync function next(element, classes) {\n  const hasTransition = testTransition(element);\n\n  /* eslint-disable-next-line */\n  return new Promise(async resolve => {\n    if (hasTransition) {\n      element.__transitionEndHandler__ = resolve;\n      element.addEventListener('transitionend', element.__transitionEndHandler__, false);\n    }\n    setClassesOrStyles(element, classes.from, 'remove');\n    if (!hasTransition) {\n      await nextFrame();\n    }\n    setClassesOrStyles(element, classes.to);\n    await nextFrame();\n    if (!hasTransition) {\n      resolve();\n    }\n  });\n}\n\n/**\n * Apply the final state.\n *\n * @return {void}\n */\nfunction end(element, classes) {\n  element.removeEventListener('transitionend', element.__transitionEndHandler__, false);\n  setClassesOrStyles(element, classes.to, 'remove');\n  setClassesOrStyles(element, classes.active, 'remove');\n  delete element.__isTransitioning__;\n  delete element.__transitionEndHandler__;\n}\n\n/**\n * Manage CSS transition with class.\n *\n * This is heavily inspired by the Vue `<transition>` component\n * and the `@barba/css` package, many thanks to them!\n *\n * @param  {HTMLElement}   element The target element.\n * @param  {String|Object} name    The name of the transition or an object with the hooks classes.\n * @return {Promise}               A promise resolving at the end of the transition.\n */\nexport default async function transition(element, name) {\n  const classes =\n    typeof name === 'string'\n      ? {\n          from: `${name}-from`,\n          active: `${name}-active`,\n          to: `${name}-to`,\n        }\n      : {\n          from: '',\n          active: '',\n          to: '',\n          ...name,\n        };\n\n  // End any previous transition running on the element.\n  if (element.__isTransitioning__) {\n    end(element, classes);\n    await nextFrame();\n  }\n\n  await start(element, classes);\n  await next(element, classes);\n  end(element, classes);\n  return Promise.resolve();\n}\n"],"file":"transition.js"}