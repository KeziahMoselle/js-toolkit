{"version":3,"file":"full.modern.js","sources":["../node_modules/nanoid/non-secure/index.js","../src/utils/object/getAllProperties.js","../src/utils/object/autoBind.js","../src/abstracts/EventManager.js","../src/abstracts/Base/utils.js","../src/abstracts/Base/children.js","../node_modules/deepmerge/dist/cjs.js","../src/abstracts/Base/options.js","../src/abstracts/Base/refs.js","../src/abstracts/Base/components.js","../src/abstracts/Service.js","../src/utils/throttle.js","../src/utils/debounce.js","../src/utils/nextFrame.js","../src/services/raf.js","../src/services/pointer.js","../src/services/resize.js","../src/services/scroll.js","../src/utils/keyCodes.js","../src/services/key.js","../src/abstracts/Base/services.js","../src/abstracts/Base/events.js","../src/abstracts/Base/index.js","../src/index.js","../src/utils/object/isObject.js","../src/utils/css/styles.js","../src/utils/css/classes.js","../src/utils/css/transition.js","../src/components/Accordion/AccordionItem.js","../src/components/Accordion/index.js","../src/components/MediaQuery.js","../src/utils/focusTrap.js","../src/components/Modal.js","../src/components/Tabs.js","../src/decorators/withBreakpointManager.js","../src/decorators/withBreakpointObserver.js","../src/decorators/withIntersectionObserver.js","../src/utils/math/damp.js","../src/utils/math/lerp.js","../src/utils/math/map.js","../src/utils/math/round.js"],"sourcesContent":["// This alphabet uses a-z A-Z 0-9 _- symbols.\n// Symbols are generated for smaller size.\n// -_zyxwvutsrqponmlkjihgfedcba9876543210ZYXWVUTSRQPONMLKJIHGFEDCBA\nvar url = '-_'\n// Loop from 36 to 0 (from z to a and 9 to 0 in Base36).\nvar i = 36\nwhile (i--) {\n  // 36 is radix. Number.prototype.toString(36) returns number\n  // in Base36 representation. Base36 is like hex, but it uses 0â€“9 and a-z.\n  url += i.toString(36)\n}\n// Loop from 36 to 10 (from Z to A in Base36).\ni = 36\nwhile (i-- - 10) {\n  url += i.toString(36).toUpperCase()\n}\n\n/**\n * Generate URL-friendly unique ID. This method use non-secure predictable\n * random generator with bigger collision probability.\n *\n * @param {number} [size=21] The number of symbols in ID.\n *\n * @return {string} Random string.\n *\n * @example\n * const nanoid = require('nanoid/non-secure')\n * model.id = nanoid() //=> \"Uakgb_J5m9g-0JDMbcJqL\"\n *\n * @name nonSecure\n * @function\n */\nmodule.exports = function (size) {\n  var id = ''\n  i = size || 21\n  // Compact alternative for `for (var i = 0; i < size; i++)`\n  while (i--) {\n    // `| 0` is compact and faster alternative for `Math.floor()`\n    id += url[Math.random() * 64 | 0]\n  }\n  return id\n}\n","/**\n * Gets all non-builtin properties up the prototype chain.\n *\n * @param  {Object} object The object to get the propeties from.\n * @param  {Array}  props  The already existing properties.\n * @return {Array}         An array of properties and their value.\n */\nexport default function getAllProperties(object, props = []) {\n  const proto = Object.getPrototypeOf(object);\n\n  if (proto === Object.prototype) {\n    return props;\n  }\n\n  return getAllProperties(\n    proto,\n    Object.getOwnPropertyNames(proto)\n      .map((name) => [name, proto])\n      .reduce((acc, val) => [...acc, val], props)\n  );\n}\n","import getAllProperties from './getAllProperties';\n\n/**\n * Auto-bind methods to an instance.\n *\n * @param  {Object}               instance        The instance.\n * @param  {Array<String|RegExp>} options.include Methods to include.\n * @param  {Array<String|RegExp>} options.exclude Methods to exclude.\n * @return {Object}                               The instance.\n */\nexport default function autoBind(instance, { include, exclude } = {}) {\n  const filter = (key) => {\n    const match = (pattern) => (typeof pattern === 'string' ? key === pattern : pattern.test(key));\n\n    if (include) {\n      return include.some(match);\n    }\n\n    if (exclude) {\n      return !exclude.some(match);\n    }\n\n    return true;\n  };\n\n  getAllProperties(instance)\n    .filter(([key]) => key !== 'constructor' && filter(key))\n    .forEach(([key, object]) => {\n      const descriptor = Object.getOwnPropertyDescriptor(object, key);\n      if (descriptor && typeof descriptor.value === 'function') {\n        instance[key] = instance[key].bind(instance);\n      }\n    });\n\n  return instance;\n}\n","/* eslint no-underscore-dangle: [\"error\", { \"allow\": [\"_events\"] }] */\n/**\n * Event management class.\n *\n * @method $on    Bind a given function to the given event.\n * @method $off   Unbind the given function from the given event.\n * @method $once  Bind a given function to the given event once.\n * @method $emit  Emit an event with custom props.\n */\nexport default class EventManager {\n  /** @type {Object} An object to store the events */\n  _events = {};\n\n  /**\n   * Bind a listener function to an event.\n   *\n   * @param  {String}   event    Name of the event.\n   * @param  {String}   listener Function to be called.\n   * @return {Function}          A function to unbind the listener.\n   */\n  $on(event, listener) {\n    if (!Array.isArray(this._events[event])) {\n      this._events[event] = [];\n    }\n    this._events[event].push(listener);\n\n    return () => {\n      this.$off(event, listener);\n    };\n  }\n\n  /**\n   * Unbind a listener function from an event.\n   *\n   * @param  {String}       event    Name of the event.\n   * @param  {String}       listener Function to be removed.\n   * @return {EventManager}          The current instance.\n   */\n  $off(event, listener) {\n    // If no event specified, we remove them all.\n    if (!event) {\n      this._events = {};\n      return this;\n    }\n    // If no listener have been specified, we remove all\n    // the listeners for the given event.\n    if (!listener) {\n      this._events[event] = [];\n      return this;\n    }\n\n    const index = this._events[event].indexOf(listener);\n\n    if (index > -1) {\n      this._events[event].splice(index, 1);\n    }\n\n    return this;\n  }\n\n  /**\n   * Emits an event.\n   *\n   * @param  {String}       event Name of the event.\n   * @param  {Array}        args  The arguments to apply to the functions bound to this event.\n   * @return {EventManager}       The current instance.\n   */\n  $emit(event, ...args) {\n    if (!Array.isArray(this._events[event])) {\n      return this;\n    }\n\n    this._events[event].forEach((listener) => {\n      listener.apply(this, args);\n    });\n    return this;\n  }\n\n  /**\n   * Bind a listener function to an event for one execution only.\n   *\n   * @param  {String}       event    Name of the event.\n   * @param  {String}       listener Function to be called.\n   * @return {EventManager}          The current instance.\n   */\n  $once(event, listener) {\n    const instance = this;\n    this.$on(event, function handler(...args) {\n      instance.$off(event, handler);\n      listener.apply(instance, args);\n    });\n    return this;\n  }\n}\n","/**\n * Verbose debug for the component.\n *\n * @param  {...any} args The arguments passed to the method\n * @return {void}\n */\nexport function debug(instance, ...args) {\n  return instance.$options.debug\n    ? window.console.log.apply(window, [instance.config.name, ...args])\n    : () => {};\n}\n\n/**\n * Test if an object has a method.\n *\n * @param  {Object}  obj The object to test\n * @param  {String}  fn  The method's name\n * @return {Boolean}\n */\nexport function hasMethod(obj, name) {\n  return typeof obj[name] === 'function';\n}\n\n/**\n * Call the given method while applying the given arguments.\n *\n * @param {String} method The method to call\n * @param {...any} args   The arguments to pass to the method\n */\nexport function callMethod(instance, method, ...args) {\n  debug(instance, 'callMethod', method, ...args);\n\n  // Prevent duplicate call of `mounted` and `destroyed`\n  // methods based on the component status\n  if (\n    (method === 'destroyed' && !instance.$isMounted) ||\n    (method === 'mounted' && instance.$isMounted)\n  ) {\n    debug(instance, 'not', method, 'because the method has already been triggered once.');\n    return instance;\n  }\n\n  instance.$emit(method, ...args);\n\n  // We always emit an event, but we do not call the method if it does not exist\n  if (!hasMethod(instance, method)) {\n    return instance;\n  }\n\n  instance[method].call(instance, ...args);\n  debug(instance, method, instance, ...args);\n\n  return instance;\n}\n","/**\n * Get a child component.\n *\n * @param  {HTMLElement}  el             The root element of the child component.\n * @param  {Base|Promise} ComponentClass A Base class or a Promise for async components.\n * @param  {Base}         parent         The parent component instance.\n * @return {Base|Promise}                A Base instance or a Promise resolving to a Base instance.\n */\nfunction getChild(el, ComponentClass, parent) {\n  // Return existing instance if it exists\n  if (el.__base__) {\n    return el.__base__;\n  }\n\n  // Return a new instance if the component class is a child of the Base class\n  if (ComponentClass.__isBase__) {\n    Object.defineProperty(ComponentClass.prototype, '__isChild__', { value: true });\n    const child = new ComponentClass(el);\n    Object.defineProperty(child, '$parent', { get: () => parent });\n    return child;\n  }\n\n  // Resolve async components\n  const asyncComponent = ComponentClass().then((module) => {\n    const ResolvedClass = module.default ? module.default : module;\n    Object.defineProperty(ResolvedClass.prototype, '__isChild__', { value: true });\n    const child = new ResolvedClass(el);\n    Object.defineProperty(child, '$parent', { get: () => parent });\n    return child;\n  });\n\n  asyncComponent.__isAsync__ = true;\n\n  return asyncComponent;\n}\n\n/**\n *\n * @param  {Base}        instance   The component's instance.\n * @param  {HTMLElement} element    The component's root element\n * @param  {Object}      components The children components' classes\n * @return {null|Object}            Returns `null` if no child components are defined or an object of all child component instances\n */\nexport function getChildren(instance, element, components) {\n  const children = Object.entries(components).reduce((acc, [name, ComponentClass]) => {\n    const selector = `[data-component=\"${name}\"]`;\n    let elements = Array.from(element.querySelectorAll(selector));\n\n    // If no child component found with the default selector, the name must be a DOM selector\n    if (elements.length === 0) {\n      elements = Array.from(element.querySelectorAll(name));\n    }\n\n    if (elements.length === 0) {\n      return acc;\n    }\n\n    acc[name] = elements\n      .map((el) => getChild(el, ComponentClass, instance))\n      // Filter out terminated children\n      .filter((el) => el !== 'terminated');\n\n    if (acc[name].length === 0) {\n      delete acc[name];\n    }\n\n    return acc;\n  }, {});\n\n  instance.$emit('get:children', children);\n  return children;\n}\n\nexport default {\n  getChildren,\n};\n","'use strict';\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction getEnumerableOwnPropertySymbols(target) {\n\treturn Object.getOwnPropertySymbols\n\t\t? Object.getOwnPropertySymbols(target).filter(function(symbol) {\n\t\t\treturn target.propertyIsEnumerable(symbol)\n\t\t})\n\t\t: []\n}\n\nfunction getKeys(target) {\n\treturn Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))\n}\n\nfunction propertyIsOnObject(object, property) {\n\ttry {\n\t\treturn property in object\n\t} catch(_) {\n\t\treturn false\n\t}\n}\n\n// Protects from prototype poisoning and unexpected merging up the prototype chain.\nfunction propertyIsUnsafe(target, key) {\n\treturn propertyIsOnObject(target, key) // Properties are safe to merge if they don't exist in the target yet,\n\t\t&& !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,\n\t\t\t&& Object.propertyIsEnumerable.call(target, key)) // and also unsafe if they're nonenumerable.\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tgetKeys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tgetKeys(source).forEach(function(key) {\n\t\tif (propertyIsUnsafe(target, key)) {\n\t\t\treturn\n\t\t}\n\n\t\tif (propertyIsOnObject(target, key) && options.isMergeableObject(source[key])) {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\t// cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()\n\t// implementations can use it. The caller may not replace it.\n\toptions.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nmodule.exports = deepmerge_1;\n","import merge from 'deepmerge';\n\n/**\n * Get a component's options.\n *\n * @param  {Base}        instance The component's instance.\n * @param  {HTMLElement} element  The component's root element.\n * @param  {Object}      config   The component's default config.\n * @return {Object}               The component's merged options.\n */\nexport function getOptions(instance, element, config) {\n  let options = {};\n  if (element.dataset.options) {\n    try {\n      options = JSON.parse(element.dataset.options);\n    } catch (err) {\n      throw new Error('Can not parse the `data-options` attribute. Is it a valid JSON string?');\n    }\n  }\n\n  options = merge(config, options);\n  instance.$emit('get:options', options);\n  return options;\n}\n\n/**\n * Set a component instance options.\n *\n * @param {Base}        instance   The component's instance.\n * @param {HTMLElement} element    The component's root element.\n * @param {Object}      newOptions The new options object.\n */\nexport function setOptions(instance, element, newOptions) {\n  let options = {};\n  if (element.dataset.options) {\n    try {\n      options = JSON.parse(element.dataset.options);\n    } catch (err) {\n      throw new Error('Can not parse the `data-options` attribute. Is it a valid JSON string?');\n    }\n  }\n  options = merge(options, newOptions);\n  element.dataset.options = JSON.stringify(options);\n}\n\nexport default {\n  getOptions,\n  setOptions,\n};\n","/**\n * Get all refs of a component.\n *\n * @param  {Base}        instance The component's instance.\n * @param  {HTMLElement} element  The component's root element.\n * @return {Object}               Return an object containing all the component's refs.\n */\nexport function getRefs(instance, element) {\n  const allRefs = Array.from(element.querySelectorAll(`[data-ref]`));\n  const childrenRefs = Array.from(element.querySelectorAll(`:scope [data-component] [data-ref]`));\n  const elements = allRefs.filter((ref) => !childrenRefs.includes(ref));\n\n  const refs = elements.reduce(($refs, $ref) => {\n    let refName = $ref.dataset.ref;\n    const $realRef = $ref.__base__ ? $ref.__base__ : $ref;\n\n    if (refName.endsWith('[]')) {\n      refName = refName.replace(/\\[\\]$/, '');\n\n      if (!$refs[refName]) {\n        $refs[refName] = [];\n      }\n    }\n\n    if ($refs[refName]) {\n      if (Array.isArray($refs[refName])) {\n        $refs[refName].push($realRef);\n      } else {\n        $refs[refName] = [$refs[refName], $realRef];\n      }\n    } else {\n      $refs[refName] = $realRef;\n    }\n\n    return $refs;\n  }, {});\n\n  instance.$emit('get:refs', refs);\n  return refs;\n}\n\nexport default {\n  getRefs,\n};\n","import { debug } from './utils';\n\n/**\n * Mount a given component which might be async.\n *\n * @param  {Base|Promise} component The component to mount.\n * @return {void}\n */\nfunction mountComponent(component) {\n  if (component.__isAsync__) {\n    component.then((instance) => instance.$mount());\n  } else {\n    component.$mount();\n  }\n}\n\n/**\n * Mount children components of a given instance.\n *\n * @param  {Base} instance The parent component's instance.\n * @return {void}\n */\nexport function mountComponents(instance) {\n  if (!instance.$children) {\n    return;\n  }\n\n  debug(instance, 'mountComponents', instance.$children);\n\n  Object.values(instance.$children).forEach(($child) => {\n    $child.forEach(mountComponent);\n  });\n}\n\n/**\n * Destroy a given component which might be async.\n *\n * @param  {Base|Promise} component The component to destroy.\n * @return {void}\n */\nfunction destroyComponent(component) {\n  if (component.__isAsync__) {\n    component.then((instance) => instance.$destroy());\n  } else {\n    component.$destroy();\n  }\n}\n\n/**\n * Destroy children components of a given instance.\n *\n * @param  {Base} instance The parent component's instance.\n * @return {void}\n */\nexport function destroyComponents(instance) {\n  if (!instance.$children) {\n    return;\n  }\n  debug(instance, 'destroyComponents', instance.$children);\n\n  Object.values(instance.$children).forEach(($child) => {\n    $child.forEach(destroyComponent);\n  });\n}\n","/**\n * Service abstract class\n */\nexport default class Service {\n  /**\n   * Class constructor, used to test the abstract class implementation.\n   *\n   * @return {Service} The current instance\n   */\n  constructor() {\n    this.callbacks = new Map();\n    this.isInit = false;\n  }\n\n  /**\n   * Getter to get the services properties.\n   * This getter MUST be implementer by the service extending this class.\n   * @return {Object}\n   */\n  get props() {\n    throw new Error('The `props` getter must be implemented.');\n  }\n\n  /**\n   * Method to initialize the service behaviors.\n   * This method MUST be implemented by the service extending this class.\n   *\n   * @return {Service} The current instance\n   */\n  init() {\n    throw new Error('The `init` method must be implemented.');\n  }\n\n  /**\n   * Method to kill the service behaviors.\n   * This method MUST be implemented by the service extending this class.\n   *\n   * @return {Service} The current instance\n   */\n  kill() {\n    throw new Error('The `kill` method must be implemented.');\n  }\n\n  /**\n   * Add a callback.\n   *\n   * @param  {String}   key      The callback's identifier\n   * @param  {Function} callback The callback function\n   * @return {Service}           The current instance\n   */\n  add(key, callback) {\n    if (this.has(key)) {\n      throw new Error(`A callback with the key \\`${key}\\` has already been registered.`);\n    }\n\n    // Initialize the service when we add the first callback\n    if (this.callbacks.size === 0 && !this.isInit) {\n      this.init();\n      this.isInit = true;\n    }\n\n    this.callbacks.set(key, callback);\n    return this;\n  }\n\n  /**\n   * Test if a callback with the given key has already been added.\n   *\n   * @param  {String}  key The identifier to test\n   * @return {Boolean}     Whether or not the identifier already exists\n   */\n  has(key) {\n    return this.callbacks.has(key);\n  }\n\n  /**\n   * Get the callback tied to the given key.\n   *\n   * @param  {String}   key The identifier to get\n   * @return {Function}     The callback function\n   */\n  get(key) {\n    return this.callbacks.get(key);\n  }\n\n  /**\n   * Remove the callback tied to the given key.\n   *\n   * @param  {String} key The identifier to remove\n   * @return {Service}    The current instance\n   */\n  remove(key) {\n    this.callbacks.delete(key);\n\n    // Kill the service when we remove the last callback\n    if (this.callbacks.size === 0 && this.isInit) {\n      this.kill();\n      this.isInit = false;\n    }\n\n    return this;\n  }\n\n  /**\n   * Trigger each added callback with the given arguments.\n   *\n   * @param  {Array}   args All the arguments to apply to the callback\n   * @return {Service}      The current instance\n   */\n  trigger(...args) {\n    this.callbacks.forEach((callback) => {\n      callback(...args);\n    });\n\n    return this;\n  }\n}\n","/**\n * Simple throttling helper that limits a\n * function to only run once every {delay}ms\n *\n * @param {Function} fn    The function to throttle\n * @param {Number}   delay The delay in ms\n */\nexport default function throttle(fn, delay = 16) {\n  let lastCall = 0;\n  return (...args) => {\n    const now = new Date().getTime();\n    if (now - lastCall < delay) {\n      return false;\n    }\n    lastCall = now;\n    return fn(...args);\n  };\n}\n","/**\n * Returns a function, that, as long as it continues to be invoked,\n * will not be triggered. The function will be called after it stops\n * being called for N milliseconds.\n *\n * @param {Function} fn    The function to call\n * @param {Number}   delay The delay in ms to wait before calling the function\n */\nexport default function debounce(fn, delay = 300) {\n  let timeout;\n  return (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => {\n      fn(...args);\n    }, delay);\n  };\n}\n","/**\n * RequestAnimation frame polyfill.\n * @see  https://github.com/vuejs/vue/blob/ec78fc8b6d03e59da669be1adf4b4b5abf670a34/dist/vue.runtime.esm.js#L7355\n * @type {Function}\n */\nexport const getRaf = () =>\n  typeof window !== 'undefined' && window.requestAnimationFrame\n    ? window.requestAnimationFrame.bind(window)\n    : setTimeout;\n\n/**\n * Execute a callback in the next frame.\n * @param  {Function} fn The callback function to execute.\n * @return {Promise}\n */\nexport default function nextFrame(fn = () => {}) {\n  const raf = getRaf();\n  return new Promise((resolve) => {\n    raf(() => raf(() => resolve(fn())));\n  });\n}\n","import Service from '../abstracts/Service';\nimport { getRaf } from '../utils/nextFrame';\n\n/**\n * Tick service\n *\n * ```\n * import { useRaf } from '@studiometa/js/services';\n * const { add, remove, props } = useRag();\n * add(id, (props) => {});\n * remove(id);\n * props();\n * ```\n */\nclass Raf extends Service {\n  /** @type {Boolean} Whether the loop is running or not. */\n  isTicking = false;\n\n  /**\n   * Start the requestAnimationFrame loop.\n   *\n   * @return {void}\n   */\n  init() {\n    const raf = getRaf();\n\n    const loop = () => {\n      this.trigger(this.props);\n\n      if (!this.isTicking) {\n        return;\n      }\n\n      raf(loop);\n    };\n\n    this.isTicking = true;\n    loop();\n  }\n\n  /**\n   * Stop the requestAnimationFrame loop.\n   *\n   * @return {void}\n   */\n  kill() {\n    this.isTicking = false;\n  }\n\n  /**\n   * Get raf props.\n   *\n   * @todo Return elapsed time / index?\n   * @type {Object}\n   */\n  get props() {\n    return {\n      time: window.performance.now(),\n    };\n  }\n}\n\nlet instance = null;\n\nexport default () => {\n  if (!instance) {\n    instance = new Raf();\n  }\n\n  const add = instance.add.bind(instance);\n  const remove = instance.remove.bind(instance);\n  const has = instance.has.bind(instance);\n  const props = () => instance.props;\n\n  return {\n    add,\n    remove,\n    has,\n    props,\n  };\n};\n","import Service from '../abstracts/Service';\nimport throttle from '../utils/throttle';\nimport debounce from '../utils/debounce';\nimport useRaf from './raf';\n\n/**\n * Pointer service\n *\n * ```\n * import { usePointer } from '@studiometa/js/services';\n * const { add, remove, props } = usePointer();\n * add(key, (props) => {});\n * remove(key);\n * props();\n * ```\n */\nclass Pointer extends Service {\n  /** @type {Boolean} State of the pointer. */\n  isDown = false;\n\n  /** @type {Number} The y pointer position. */\n  y = window.innerHeight / 2;\n\n  /** @type {Number} The y previous pointer position. */\n  yLast = window.innerHeight / 2;\n\n  /** @type {Number} The x pointer position. */\n  x = window.innerWidth / 2;\n\n  /** @type {Number} The x previous pointer position. */\n  xLast = window.innerWidth / 2;\n\n  /**\n   * Bind the handler to the mousemove and touchmove events.\n   * Bind the up and down handler to the mousedown, mouseup, touchstart and touchend events.\n   *\n   * @return {void}\n   */\n  init() {\n    const { add, remove } = useRaf();\n    this.hasRaf = false;\n\n    const debounced = debounce((event) => {\n      this.updateValues(event);\n      remove('usePointer');\n      this.trigger(this.props);\n      this.hasRaf = false;\n    }, 50);\n\n    this.handler = throttle((event) => {\n      this.updateValues(event);\n      if (!this.hasRaf) {\n        add('usePointer', () => {\n          this.trigger(this.props);\n        });\n        this.hasRaf = true;\n      }\n      // Reset changed flags at the end of the mousemove or touchmove event\n      debounced(event);\n    }, 32).bind(this);\n\n    this.downHandler = this.downHandler.bind(this);\n    this.upHandler = this.upHandler.bind(this);\n\n    document.documentElement.addEventListener('mouseenter', this.handler, { once: true });\n    document.addEventListener('mousemove', this.handler, { passive: true });\n    document.addEventListener('touchmove', this.handler, { passive: true });\n    document.addEventListener('mousedown', this.downHandler, { passive: true });\n    document.addEventListener('touchstart', this.downHandler, { passive: true });\n    document.addEventListener('mouseup', this.upHandler, { passive: true });\n    document.addEventListener('touchend', this.upHandler, { passive: true });\n  }\n\n  /**\n   * Unbind all handlers from their bounded event.\n   *\n   * @return {void}\n   */\n  kill() {\n    document.removeEventListener('mousemove', this.handler);\n    document.removeEventListener('touchmove', this.handler);\n    document.removeEventListener('mousedown', this.downHandler);\n    document.removeEventListener('touchstart', this.downHandler);\n    document.removeEventListener('mouseup', this.upHandler);\n    document.removeEventListener('touchend', this.upHandler);\n  }\n\n  /**\n   * Handler for the pointer's down action.\n   *\n   * @return {void}\n   */\n  downHandler() {\n    this.isDown = true;\n    this.trigger(this.props);\n  }\n\n  /**\n   * Handler for the pointer's up action.\n   *\n   * @return {void}\n   */\n  upHandler() {\n    this.isDown = false;\n    this.trigger(this.props);\n  }\n\n  /**\n   * Update the pointer positions.\n   *\n   * @param  {Event} event The event object.\n   * @return {void}\n   */\n  updateValues(event) {\n    this.yLast = this.y;\n    this.xLast = this.x;\n\n    // Check pointer Y\n    // We either get data from a touch event `event.touches[0].clientY` or from\n    // a mouse event `event.clientY`.\n    if (((event.touches || [])[0] || event || {}).clientY !== this.y) {\n      this.y = ((event.touches || [])[0] || event || {}).clientY;\n    }\n\n    // Check pointer X\n    // We either get data from a touch event `event.touches[0].clientX` or from\n    // a mouse event `event.clientX`.\n    if (((event.touches || [])[0] || event || {}).clientX !== this.x) {\n      this.x = ((event.touches || [])[0] || event || {}).clientX;\n    }\n  }\n\n  /**\n   * Get the pointer props.\n   *\n   * @type {Object}\n   */\n  get props() {\n    return {\n      isDown: this.isDown,\n      x: this.x,\n      y: this.y,\n      changed: {\n        x: this.x !== this.xLast,\n        y: this.y !== this.yLast,\n      },\n      last: {\n        x: this.xLast,\n        y: this.yLast,\n      },\n      delta: {\n        x: this.x - this.xLast,\n        y: this.y - this.yLast,\n      },\n      progress: {\n        x: this.x / window.innerWidth,\n        y: this.y / window.innerHeight,\n      },\n      max: {\n        x: window.innerWidth,\n        y: window.innerHeight,\n      },\n    };\n  }\n}\n\nlet pointer = null;\n\n/**\n * Use the pointer.\n *\n * ```js\n * import usePointer from '@studiometa/js-toolkit/services';\n * const { add, remove, props } = usePointer();\n * add('id', () => {});\n * remove('id');\n * props();\n * ```\n */\nexport default () => {\n  if (!pointer) {\n    pointer = new Pointer();\n  }\n\n  const add = pointer.add.bind(pointer);\n  const remove = pointer.remove.bind(pointer);\n  const has = pointer.has.bind(pointer);\n  const props = () => pointer.props;\n\n  return {\n    add,\n    remove,\n    has,\n    props,\n  };\n};\n","import Service from '../abstracts/Service';\nimport debounce from '../utils/debounce';\n\n/**\n * Resize service\n *\n * ```\n * import { useResize } from '@studiometa/js/services';\n * const { add, remove, props } = useResize();\n * add(key, (props) => {});\n * remove(key);\n * props();\n * ```\n */\nclass Resize extends Service {\n  /**\n   * Bind the handler to the resize event.\n   *\n   * @return {void}\n   */\n  init() {\n    this.handler = debounce(() => {\n      this.trigger(this.props);\n    }).bind(this);\n\n    if (this.canUseResizeObserver) {\n      this.resizeObserver = new ResizeObserver(this.handler);\n      this.resizeObserver.observe(document.documentElement);\n    } else {\n      window.addEventListener('resize', this.handler);\n    }\n  }\n\n  /**\n   * Unbind the handler from the resize event.\n   *\n   * @return {void}\n   */\n  kill() {\n    if (this.canUseResizeObserver) {\n      this.resizeObserver.disconnect();\n    } else {\n      window.removeEventListener('resize', this.handler);\n    }\n    delete this.resizeObserver;\n  }\n\n  /**\n   * Get resize props.\n   *\n   * @type {Object}\n   */\n  get props() {\n    const props = {\n      width: window.innerWidth,\n      height: window.innerHeight,\n      ratio: window.innerWidth / window.innerHeight,\n      orientation: 'square',\n    };\n\n    if (props.ratio > 1) {\n      props.orientation = 'landscape';\n    }\n\n    if (props.ratio < 1) {\n      props.orientation = 'portrait';\n    }\n\n    if (this.breakpointElement) {\n      props.breakpoint = this.breakpoint;\n      props.breakpoints = this.breakpoints;\n    }\n\n    return props;\n  }\n\n  /**\n   * The element holding the breakpoints data.\n   * @return {HTMLElement}\n   */\n  get breakpointElement() {\n    return document.querySelector('[data-breakpoint]') || null;\n  }\n\n  /**\n   * Get the current breakpoint.\n   * @return {String}\n   */\n  get breakpoint() {\n    return window\n      .getComputedStyle(this.breakpointElement, '::before')\n      .getPropertyValue('content')\n      .replace(/\"/g, '');\n  }\n\n  /**\n   * Get all breakpoints.\n   * @return {Array}\n   */\n  get breakpoints() {\n    const breakpoints = window\n      .getComputedStyle(this.breakpointElement, '::after')\n      .getPropertyValue('content')\n      .replace(/\"/g, '');\n\n    return breakpoints.split(',');\n  }\n\n  /**\n   * Test if we can use the `ResizeObserver` API.\n   * @return {Boolean}\n   */\n  get canUseResizeObserver() {\n    return typeof window.ResizeObserver !== 'undefined';\n  }\n}\n\nlet resize = null;\n\nexport default () => {\n  if (!resize) {\n    resize = new Resize();\n  }\n\n  const add = resize.add.bind(resize);\n  const remove = resize.remove.bind(resize);\n  const has = resize.has.bind(resize);\n  const props = () => resize.props;\n\n  return {\n    add,\n    remove,\n    has,\n    props,\n  };\n};\n","import Service from '../abstracts/Service';\nimport throttle from '../utils/throttle';\nimport debounce from '../utils/debounce';\nimport nextFrame from '../utils/nextFrame';\n\n/**\n * Scroll service\n *\n * ```\n * import { useScroll } from '@studiometa/js-toolkit/services';\n * const { add, remove, props } = useScroll();\n * add(key, (props) => {});\n * remove(key);\n * props();\n * ```\n */\nclass Scroll extends Service {\n  /** @type {Number} The y scroll position. */\n  y = window.pageYOffset;\n\n  /** @type {Number} The y previous scroll position. */\n  yLast = window.pageYOffset;\n\n  /** @type {Number} The x scroll position. */\n  x = window.pageXOffset;\n\n  /** @type {Number} The x previous scroll position. */\n  xLast = window.pageXOffset;\n\n  /**\n   * Bind the handler to the scroll event.\n   *\n   * @return {void}\n   */\n  init() {\n    const debounced = debounce(() => {\n      this.trigger(this.props);\n      nextFrame(() => {\n        this.trigger(this.props);\n      });\n    }, 50);\n\n    this.handler = throttle(() => {\n      this.trigger(this.props);\n\n      // Reset changed flags at the end of the scroll event\n      debounced();\n    }, 32).bind(this);\n\n    // Fire the `scrolled` method on document scroll\n    document.addEventListener('scroll', this.handler, { passive: true });\n  }\n\n  /**\n   * Unbind the handler from the scroll event.\n   *\n   * @return {void}\n   */\n  kill() {\n    document.removeEventListener('scroll', this.handler);\n  }\n\n  /**\n   * Get scroll props.\n   *\n   * @type {Object}\n   */\n  get props() {\n    this.yLast = this.y;\n    this.xLast = this.x;\n\n    // Check scroll Y\n    if (window.pageYOffset !== this.y) {\n      this.y = window.pageYOffset;\n    }\n\n    // Check scroll x\n    if (window.pageXOffset !== this.x) {\n      this.x = window.pageXOffset;\n    }\n\n    return {\n      x: this.x,\n      y: this.y,\n      changed: {\n        x: this.x !== this.xLast,\n        y: this.y !== this.yLast,\n      },\n      last: {\n        x: this.xLast,\n        y: this.yLast,\n      },\n      delta: {\n        x: this.x - this.xLast,\n        y: this.y - this.yLast,\n      },\n      progress: {\n        x: this.max.x === 0 ? 1 : this.x / this.max.x,\n        y: this.max.y === 0 ? 1 : this.y / this.max.y,\n      },\n      max: this.max,\n    };\n  }\n\n  /**\n   * Get scroll max values.\n   *\n   * @type {Object}\n   */\n  get max() {\n    return {\n      x: (document.scrollingElement || document.body).scrollWidth - window.innerWidth,\n      y: (document.scrollingElement || document.body).scrollHeight - window.innerHeight,\n    };\n  }\n}\n\nlet scroll = null;\n\nexport default () => {\n  if (!scroll) {\n    scroll = new Scroll();\n  }\n\n  const add = scroll.add.bind(scroll);\n  const remove = scroll.remove.bind(scroll);\n  const has = scroll.has.bind(scroll);\n  const props = () => scroll.props;\n\n  return {\n    add,\n    remove,\n    has,\n    props,\n  };\n};\n","export default {\n  ENTER: 13,\n  SPACE: 32,\n  TAB: 9,\n  ESC: 27,\n  LEFT: 37,\n  UP: 38,\n  RIGHT: 39,\n  DOWN: 40,\n};\n","import Service from '../abstracts/Service';\nimport keyCodes from '../utils/keyCodes';\n\n/**\n * Scroll service\n *\n * ```\n * import { useKey } from '@studiometa/js-toolkit/services';\n * const { add, remove, props } = useKey();\n * add(key, (props) => {});\n * remove(key);\n * props();\n * ```\n */\nclass Key extends Service {\n  /** @type {Object} The event object. */\n  event = {};\n\n  /**\n   * Used to accumulate the number of times the `keydown` event has been triggered.\n   * @type {Number}\n   */\n  triggered = 0;\n\n  /** @type {Object} The previous event object. */\n  previousEvent = {};\n\n  /**\n   * Bind the handler to the keyboard event.\n   *\n   * @return {void}\n   */\n  init() {\n    this.handler = (event) => {\n      this.event = event;\n      this.trigger(this.props);\n    };\n    document.addEventListener('keydown', this.handler, { passive: false });\n    document.addEventListener('keyup', this.handler, { passive: false });\n  }\n\n  /**\n   * Unbind the handler from the keyboard event.\n   *\n   * @return {void}\n   */\n  kill() {\n    document.removeEventListener('keydown', this.handler);\n    document.removeEventListener('keyup', this.handler);\n  }\n\n  /**\n   * Get keyboard props.\n   *\n   * @type {Object}\n   */\n  get props() {\n    const keys = Object.entries(keyCodes).reduce((acc, [name, code]) => {\n      acc[name] = code === this.event.keyCode;\n      return acc;\n    }, {});\n\n    if (!this.previousEvent.type) {\n      this.triggered = 0;\n    }\n\n    if (this.event.type === 'keydown' && this.previousEvent.type === 'keydown') {\n      this.triggered += 1;\n    } else {\n      this.triggered = 1;\n    }\n\n    this.previousEvent = this.event;\n\n    return {\n      event: this.event,\n      triggered: this.triggered,\n      direction: this.event.type === 'keydown' ? 'down' : 'up',\n      isUp: this.event.type === 'keyup',\n      isDown: this.event.type === 'keydown',\n      ...keys,\n    };\n  }\n}\n\nlet key = null;\n\nexport default () => {\n  if (!key) {\n    key = new Key();\n  }\n\n  const add = key.add.bind(key);\n  const remove = key.remove.bind(key);\n  const has = key.has.bind(key);\n  const props = () => key.props;\n\n  return {\n    add,\n    remove,\n    has,\n    props,\n  };\n};\n","import usePointer from '../../services/pointer';\nimport useRaf from '../../services/raf';\nimport useResize from '../../services/resize';\nimport useScroll from '../../services/scroll';\nimport useKey from '../../services/key';\nimport { hasMethod, callMethod } from './utils';\n\n/**\n * Init the given service and bind it to the given instance.\n *\n * @param  {Base}     instance The Base instance.\n * @param  {String}   method   The instance to test for binding\n * @param  {Function} service  The service `use...` function\n * @return {Function}          A function to unbind the service\n */\nfunction initService(instance, method, service) {\n  if (!hasMethod(instance, method)) {\n    return () => {};\n  }\n\n  const { add, remove } = service();\n  add(instance.$id, (...args) => {\n    callMethod(instance, method, ...args);\n  });\n\n  return () => remove(instance.$id);\n}\n\n/**\n * Use the services.\n * @param  {Base} instance A Base class instance.\n * @return {Array}         A list of unbind methods.\n */\nexport default function bindServices(instance) {\n  const unbindMethods = [\n    initService(instance, 'scrolled', useScroll),\n    initService(instance, 'resized', useResize),\n    initService(instance, 'ticked', useRaf),\n    initService(instance, 'moved', usePointer),\n    initService(instance, 'keyed', useKey),\n  ];\n\n  // Fire the `loaded` method on window load\n  // @todo remove this? or move it elsewhere?\n  if (hasMethod(instance, 'loaded')) {\n    const loadedHandler = (event) => {\n      callMethod(instance, 'loaded', { event });\n    };\n    window.addEventListener('load', loadedHandler);\n    unbindMethods.push(() => {\n      window.removeEventListener('load', loadedHandler);\n    });\n  }\n\n  return unbindMethods;\n}\n","import getAllProperties from '../../utils/object/getAllProperties';\nimport { debug } from './utils';\n\n/**\n * Bind event handler methods to the root HTML element.\n *\n * @param  {Base}  instance     A Base instance.\n * @param  {Array} eventMethods A list of methods to bind.\n * @return {Array}              A list of unbind functions.\n */\nfunction bindRootEvents(instance, eventMethods) {\n  return eventMethods.map((eventMethod) => {\n    const eventName = eventMethod.replace(/^on/, '').toLowerCase();\n\n    const handler = (...args) => {\n      debug(instance, eventMethod, instance.$el, ...args);\n      instance[eventMethod](...args);\n    };\n\n    instance.$el.addEventListener(eventName, handler);\n\n    return () => {\n      instance.$el.removeEventListener(eventName, handler);\n    };\n  });\n}\n\n/**\n * Bind event handler methods to refs HTML element.\n *\n * @param  {Base}  instance     A Base instance.\n * @param  {Array} eventMethods A list of methods to bind.\n * @return {Array}              A list of unbind functions.\n */\nfunction bindRefsEvents(instance, eventMethods) {\n  const unbindMethods = [];\n\n  Object.entries(instance.$refs).forEach(([refName, $refOrRefs]) => {\n    const $refs = Array.isArray($refOrRefs) ? $refOrRefs : [$refOrRefs];\n    const refEventMethod = `on${refName.replace(/^\\w/, (c) => c.toUpperCase())}`;\n\n    eventMethods\n      .filter((eventMethod) => eventMethod.startsWith(refEventMethod))\n      .forEach((eventMethod) => {\n        $refs.forEach(($ref, index) => {\n          const eventName = eventMethod.replace(refEventMethod, '').toLowerCase();\n          const handler = (...args) => {\n            debug(instance, eventMethod, $ref, ...args, index);\n            instance[eventMethod](...args, index);\n          };\n\n          debug(instance, 'binding ref event', refName, eventName);\n\n          if ($ref.constructor && $ref.constructor.__isBase__) {\n            // eslint-disable-next-line no-param-reassign\n            $ref = $ref.$el;\n          }\n\n          $ref.addEventListener(eventName, handler);\n          const unbindMethod = () => {\n            debug(instance, 'unbinding ref event', eventMethods);\n            $ref.removeEventListener(eventName, handler);\n          };\n\n          unbindMethods.push(unbindMethod);\n        });\n      });\n  });\n\n  return unbindMethods;\n}\n\n/**\n * Bind event handler methods to children Base instance.\n * @param  {Base}  instance     A Base instance.\n * @param  {Array} eventMethods A list of methods to bind.\n * @return {Array}              A list of unbind functions.\n */\nfunction bindChildrenEvents(instance, eventMethods) {\n  const unbindMethods = [];\n\n  Object.entries(instance.$children).forEach(([childName, $children]) => {\n    const childEventMethod = `on${childName.replace(/^\\w/, (c) => c.toUpperCase())}`;\n\n    eventMethods\n      .filter((eventMethod) => eventMethod.startsWith(childEventMethod))\n      .forEach((eventMethod) => {\n        $children.forEach(($child, index) => {\n          const eventName = eventMethod.replace(childEventMethod, '').toLowerCase();\n          const handler = (...args) => {\n            debug(instance, eventMethod, $child, ...args, index);\n            instance[eventMethod](...args, index);\n          };\n\n          debug(instance, 'binding child event', childName, eventName);\n\n          const unbindMethod = $child.$on(eventName, handler);\n          unbindMethods.push(() => {\n            debug(instance, 'unbinding child event', childName, eventName);\n            unbindMethod();\n          });\n        });\n      });\n  });\n\n  return unbindMethods;\n}\n\n/**\n * Bind ref and children component's events to their corresponding method.\n *\n * @param  {Base} instance  A Base instance.\n * @return {Array}          A list of methods to unbind the events.\n */\nexport default function bindEvents(instance) {\n  const ROOT_EVENT_REGEX = /^on[A-Z][a-z]+$/;\n  const REFS_CHILDREN_EVENT_REGEX = /^on([A-Z][a-z]+)([A-Z][a-z]+)+$/;\n\n  // Get all event methods\n  const eventMethods = getAllProperties(instance).reduce(\n    (acc, [name]) => {\n      // Testing camelCase with one word: onEvent.\n      if (ROOT_EVENT_REGEX.test(name)) {\n        acc.root.push(name);\n        return acc;\n      }\n\n      // Testing camelCase with more than two words: onRefEvent.\n      if (REFS_CHILDREN_EVENT_REGEX.test(name)) {\n        acc.refsOrChildren.push(name);\n      }\n\n      return acc;\n    },\n    { root: [], refsOrChildren: [] }\n  );\n\n  const unbindMethods = [\n    ...bindRootEvents(instance, eventMethods.root),\n    ...bindRefsEvents(instance, eventMethods.refsOrChildren),\n    ...bindChildrenEvents(instance, eventMethods.refsOrChildren),\n  ];\n\n  return unbindMethods;\n}\n","import nanoid from 'nanoid/non-secure';\nimport autoBind from '../../utils/object/autoBind';\nimport EventManager from '../EventManager';\nimport { callMethod, debug } from './utils';\nimport { getChildren } from './children';\nimport { getOptions, setOptions } from './options';\nimport { getRefs } from './refs';\nimport { mountComponents, destroyComponents } from './components';\nimport bindServices from './services';\nimport bindEvents from './events';\n\n/**\n * Page lifecycle class\n *\n * @method mounted   Fired when the class is instantiated\n * @method loaded    Fired on the window's load event\n * @method ticked    Fired each frame with `requestAnimationFrame`\n * @method resized   Fired when the window is resized (`resize` event)\n * @method moved     Fired when the pointer has moved (`touchmove` and `mousemove` events)\n * @method scrolled  Fired with debounce when the document is scrolled (`scroll` event)\n * @method destroyed Fired when the window is being unloaded (`unload` event)\n */\nexport default class Base extends EventManager {\n  /**\n   * Get the component's refs.\n   * @return {Object}\n   */\n  get $refs() {\n    return getRefs(this, this.$el);\n  }\n\n  /**\n   * Get the component's children components.\n   * @return {Object}\n   */\n  get $children() {\n    return getChildren(this, this.$el, this.config.components || {});\n  }\n\n  /**\n   * Get the component's merged config and options.\n   * @return {Object}\n   */\n  get $options() {\n    return getOptions(this, this.$el, this.config);\n  }\n\n  /**\n   * Set the components option.\n   * @param  {Object} value The new options values to merge with the old ones.\n   * @return {void}\n   */\n  set $options(newOptions) {\n    setOptions(this, this.$el, newOptions);\n  }\n\n  /**\n   * Class constructor where all the magic takes place.\n   *\n   * @param  {HTMLElement} element The component's root element.\n   * @return {Base}                A Base instance.\n   */\n  constructor(element) {\n    super();\n\n    if (!this.config) {\n      throw new Error('The `config` getter must be defined.');\n    }\n\n    if (!this.config.name) {\n      throw new Error('The `config.name` property is required.');\n    }\n\n    if (!element) {\n      throw new Error('The root element must be defined.');\n    }\n\n    Object.defineProperties(this, {\n      $id: {\n        value: `${this.config.name}-${nanoid()}`,\n      },\n      $isMounted: {\n        value: false,\n        writable: true,\n      },\n      $el: {\n        value: element,\n      },\n    });\n\n    if (!this.$el.__base__) {\n      Object.defineProperty(this.$el, '__base__', {\n        get: () => this,\n        configurable: true,\n      });\n    }\n\n    // Autobind all methods to the instance\n    autoBind(this, {\n      exclude: [\n        '$mount',\n        '$update',\n        '$destroy',\n        '$terminate',\n        '$log',\n        '$on',\n        '$once',\n        '$off',\n        '$emit',\n        'mounted',\n        'loaded',\n        'ticked',\n        'resized',\n        'moved',\n        'keyed',\n        'scrolled',\n        'destroyed',\n        'terminated',\n        ...(this._excludeFromAutoBind || []),\n      ],\n    });\n\n    let unbindMethods = [];\n    this.$on('mounted', () => {\n      mountComponents(this);\n      unbindMethods = [...bindServices(this), ...bindEvents(this)];\n      this.$isMounted = true;\n    });\n\n    this.$on('updated', () => {\n      unbindMethods.forEach((method) => method());\n      mountComponents(this);\n      unbindMethods = [...bindServices(this), ...bindEvents(this)];\n    });\n\n    this.$on('destroyed', () => {\n      this.$isMounted = false;\n      unbindMethods.forEach((method) => method());\n      destroyComponents(this);\n    });\n\n    // Mount class which are not used as another component's child.\n    if (!this.__isChild__) {\n      this.$mount();\n      Object.defineProperty(this, '$parent', { get: () => null });\n    }\n\n    debug(this, 'constructor', this);\n    return this;\n  }\n\n  /**\n   * Small helper to log stuff.\n   *\n   * @param  {...any} args The arguments passed to the method\n   * @return {void}\n   */\n  $log(...args) {\n    return this.$options.log\n      ? window.console.log.apply(window, [this.config.name, ...args])\n      : () => {};\n  }\n\n  /**\n   * Trigger the `mounted` callback.\n   */\n  $mount() {\n    debug(this, '$mount');\n    callMethod(this, 'mounted');\n    return this;\n  }\n\n  /**\n   * Update the instance children.\n   */\n  $update() {\n    debug(this, '$update');\n    callMethod(this, 'updated');\n    return this;\n  }\n\n  /**\n   * Trigger the `destroyed` callback.\n   */\n  $destroy() {\n    debug(this, '$destroy');\n    callMethod(this, 'destroyed');\n    return this;\n  }\n\n  /**\n   * Terminate a child instance when it is not needed anymore.\n   * @return {void}\n   */\n  $terminate() {\n    debug(this, '$terminate');\n\n    // First, destroy the component.\n    this.$destroy();\n\n    // Execute the `terminated` hook if it exists\n    callMethod(this, 'terminated');\n\n    // Delete the reference to the instance\n    delete this.$el.__base__;\n\n    // And update its status to prevent re-instantiation when accessing the\n    // parent's `$children` property\n    Object.defineProperty(this.$el, '__base__', {\n      value: 'terminated',\n      configurable: false,\n      writable: false,\n    });\n  }\n}\n\nBase.__isBase__ = true;\n","import Base from './abstracts/Base';\n\n/**\n * Define a component without a class.\n *\n * @param  {Object} options The component's object\n * @return {Base}           A component's class.\n */\nexport function defineComponent(options) {\n  const { config, methods, ...hooks } = options;\n\n  if (!config) {\n    throw new Error('The `config` property is required.');\n  }\n\n  if (!config.name) {\n    throw new Error('The `config.name` property is required.');\n  }\n\n  /**\n   * Component class.\n   */\n  class Component extends Base {\n    /**\n     * Component config.\n     */\n    get config() {\n      return config;\n    }\n  }\n\n  const allowedHooks = [\n    'mounted',\n    'loaded',\n    'ticked',\n    'resized',\n    'moved',\n    'keyed',\n    'scrolled',\n    'destroyed',\n    'terminated',\n  ];\n\n  const filteredHooks = Object.entries(hooks).reduce((acc, [name, fn]) => {\n    if (allowedHooks.includes(name)) {\n      acc[name] = fn;\n    } else {\n      throw new Error(\n        `\n          The \"${name}\" method is not a Base lifecycle hook,\n          it should be placed in the \"method\" property.\n          The following hooks are available: ${allowedHooks.join(', ')}\n        `\n      );\n    }\n\n    return acc;\n  }, {});\n\n  [...Object.entries(methods || {}), ...Object.entries(filteredHooks)].forEach(([name, fn]) => {\n    Component.prototype[name] = fn;\n  });\n\n  return Component;\n}\n\n/**\n * Create a Base instance with the given object configuration.\n * @param {HTMLElement|String} elementOrSelector The instance root HTML element.\n * @param {Object}             options           The Base class configuration.\n */\nexport function createBase(elementOrSelector, options) {\n  const Component = defineComponent(options);\n\n  if (elementOrSelector.length) {\n    return [...elementOrSelector].map((el) => new Component(el));\n  }\n\n  return new Component(elementOrSelector);\n}\n\nexport default Base;\n","/**\n * Test if the given value is an object.\n *\n * @param  {*}       value The value to test.\n * @return {Boolean}       Whether or not the value is an object.\n */\nexport default function isObject(value) {\n  return typeof value === 'object' && !!value && value.toString() === '[object Object]';\n}\n","import isObject from '../object/isObject';\n\n/**\n * Manage a list of style properties on an element.\n *\n * @param {HTMLElement}         element The element to update.\n * @param {CSSStyleDeclaration} styles  An object of styles properties and values.\n * @param {String}              method  The method to use: add or remove.\n */\nexport default function setStyles(element, styles, method = 'add') {\n  if (!element || !styles || !isObject(styles)) {\n    return;\n  }\n\n  Object.entries(styles).forEach(([prop, value]) => {\n    element.style[prop] = method === 'add' ? value : '';\n  });\n}\n\n/**\n * Add class names to an element.\n *\n * @param {HTMLElement} element    The element to update.\n * @param {String}      classNames A string of class names.\n * @return {void}\n */\nexport function add(element, classNames) {\n  setStyles(element, classNames);\n}\n\n/**\n * Remove class names from an element.\n *\n * @param  {HTMLElement} element    The element to update.\n * @param  {String}      classNames A string of class names.\n * @return {void}\n */\nexport function remove(element, classNames) {\n  setStyles(element, classNames, 'remove');\n}\n","/**\n * Manage a list of classes as string on an element.\n *\n * @param {HTMLElement} element    The element to update.\n * @param {String}      classNames A string of class names.\n * @param {String}      method     The method to use: add, remove or toggle.\n */\nfunction setClasses(element, classNames, method = 'add') {\n  if (!element || !classNames) {\n    return;\n  }\n\n  classNames.split(' ').forEach((className) => {\n    element.classList[method](className);\n  });\n}\n\n/**\n * Add class names to an element.\n *\n * @param {HTMLElement} element    The element to update.\n * @param {String}      classNames A string of class names.\n * @return {void}\n */\nexport function add(element, classNames) {\n  setClasses(element, classNames);\n}\n\n/**\n * Remove class names from an element.\n *\n * @param  {HTMLElement} element    The element to update.\n * @param  {String}      classNames A string of class names.\n * @return {void}\n */\nexport function remove(element, classNames) {\n  setClasses(element, classNames, 'remove');\n}\n\n/**\n * Toggle class names from an element.\n *\n * @param  {HTMLElement} element    The element to update.\n * @param  {String}      classNames A string of class names.\n * @return {void}\n */\nexport function toggle(element, classNames) {\n  setClasses(element, classNames, 'toggle');\n}\n","/* eslint no-underscore-dangle: [\"error\", { \"allow\": [\"__isTransitioning__\", \"__transitionEndHandler__\"] }] */\nimport nextFrame from '../nextFrame';\nimport * as classes from './classes';\nimport * as styles from './styles';\n\n/**\n * Update either the classes or the styles of an element with the given method.\n *\n * @param {HTMLElement}   element         The element to update.\n * @param {String|Object} classesOrStyles The classes or styles to apply.\n * @param {String}        method          The method to use, one of `add` or `remove`.\n */\nexport function setClassesOrStyles(element, classesOrStyles, method = 'add') {\n  if (typeof classesOrStyles === 'string') {\n    classes[method](element, classesOrStyles, method);\n  } else {\n    styles[method](element, classesOrStyles, method);\n  }\n}\n\n/**\n * Test if the given element has a transition duration.\n *\n * @param  {HTMLElement} element The element to test.\n * @return {Boolean}             The result of the test.\n */\nfunction testTransition(element) {\n  if (typeof window === 'undefined') {\n    return false;\n  }\n\n  const { transitionDuration } = window.getComputedStyle(element);\n  return !!transitionDuration && transitionDuration !== '0s';\n}\n\n/**\n * Apply the from state.\n *\n * @param {HTMLElement}   element         The target element.\n * @param {String|Object} classesOrStyles The classes or styles definition.\n * @return {Promise}\n */\nasync function start(element, classesOrStyles) {\n  element.__isTransitioning__ = true;\n  setClassesOrStyles(element, classesOrStyles.from);\n  await nextFrame();\n  setClassesOrStyles(element, classesOrStyles.active);\n  await nextFrame();\n}\n\n/**\n * Apply the active state.\n *\n * @param {HTMLElement}   element         The target element.\n * @param {String|Object} classesOrStyles The classes or styles definition.\n * @return {Promise}\n */\nasync function next(element, classesOrStyles) {\n  const hasTransition = testTransition(element);\n\n  /* eslint-disable-next-line */\n  return new Promise(async resolve => {\n    if (hasTransition) {\n      element.__transitionEndHandler__ = resolve;\n      element.addEventListener('transitionend', element.__transitionEndHandler__, false);\n    }\n    setClassesOrStyles(element, classesOrStyles.from, 'remove');\n    setClassesOrStyles(element, classesOrStyles.to);\n    await nextFrame();\n    if (!hasTransition) {\n      resolve();\n    }\n  });\n}\n\n/**\n * Apply the final state.\n *\n * @param {HTMLElement}   element         The target element.\n * @param {String|Object} classesOrStyles The classes or styles definition.\n * @param {String}        mode            Whether to remove or keep the `to`  classes/styles.\n * @return {void}\n */\nfunction end(element, classesOrStyles, mode = 'remove') {\n  element.removeEventListener('transitionend', element.__transitionEndHandler__, false);\n  if (mode === 'remove') {\n    setClassesOrStyles(element, classesOrStyles.to, 'remove');\n  }\n  setClassesOrStyles(element, classesOrStyles.active, 'remove');\n  delete element.__isTransitioning__;\n  delete element.__transitionEndHandler__;\n}\n\n/**\n * Manage CSS transition with class.\n *\n * This is heavily inspired by the Vue `<transition>` component\n * and the `@barba/css` package, many thanks to them!\n *\n * @param  {HTMLElement}   element The target element.\n * @param  {String|Object} name    The name of the transition or an object with the hooks classesOrStyles.\n * @param  {String}        endMode    Whether to remove or keep the `to` classes/styles\n * @return {Promise}               A promise resolving at the end of the transition.\n */\nexport default async function transition(element, name, endMode = 'remove') {\n  const classesOrStyles =\n    typeof name === 'string'\n      ? {\n          from: `${name}-from`,\n          active: `${name}-active`,\n          to: `${name}-to`,\n        }\n      : {\n          from: '',\n          active: '',\n          to: '',\n          ...name,\n        };\n\n  // End any previous transition running on the element.\n  if (element.__isTransitioning__) {\n    end(element, classesOrStyles);\n  }\n\n  await start(element, classesOrStyles);\n  await next(element, classesOrStyles);\n  end(element, classesOrStyles, endMode);\n  return Promise.resolve();\n}\n","import Base from '../../abstracts/Base';\nimport * as styles from '../../utils/css/styles';\nimport transition from '../../utils/css/transition';\n\n/**\n * AccordionItem class.\n */\nexport default class AccordionItem extends Base {\n  /**\n   * AccordionItem config\n   * @return {Object}\n   */\n  get config() {\n    return {\n      name: 'AccordionItem',\n      isOpen: false,\n      styles: {\n        container: {\n          open: '',\n          active: '',\n          closed: '',\n        },\n      },\n    };\n  }\n\n  /**\n   * Add aria-attributes on mounted.\n   * @return {void}\n   */\n  mounted() {\n    if (this.$parent && this.$parent.$options.item) {\n      this.$options = this.$parent.$options.item;\n    }\n\n    this.$refs.btn.setAttribute('id', this.$id);\n    this.$refs.btn.setAttribute('aria-controls', this.contentId);\n    this.$refs.content.setAttribute('aria-labelledby', this.$id);\n    this.$refs.content.setAttribute('id', this.contentId);\n\n    this.isOpen = this.$options.isOpen;\n    this.updateAttributes(this.isOpen);\n\n    if (!this.isOpen) {\n      styles.add(this.$refs.container, { visibility: 'invisible', height: 0 });\n    }\n\n    // Update refs styles on mount\n    const { container, ...otherStyles } = this.$options.styles;\n    Object.entries(otherStyles)\n      .filter(([refName]) => this.$refs[refName])\n      .forEach(([refName, { open, closed } = {}]) => {\n        transition(this.$refs[refName], { to: this.isOpen ? open : closed }, 'keep');\n      });\n  }\n\n  /**\n   * Handler for the click event on the `btn` ref.\n   * @return {void}\n   */\n  onBtnClick() {\n    if (this.isOpen) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  /**\n   * Get the content ID.\n   * @return {String}\n   */\n  get contentId() {\n    return `content-${this.$id}`;\n  }\n\n  /**\n   * Update the refs' attributes according to the given type.\n   *\n   * @param  {Boolean} isOpen The state of the item.\n   * @return {void}\n   */\n  updateAttributes(isOpen) {\n    this.$refs.content.setAttribute('aria-hidden', isOpen ? 'false' : 'true');\n    this.$refs.btn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');\n  }\n\n  /**\n   * Open an item.\n   * @return {void}\n   */\n  async open() {\n    if (this.isOpen) {\n      return;\n    }\n\n    this.$log('open');\n    this.$emit('open');\n\n    this.isOpen = true;\n    this.updateAttributes(this.isOpen);\n\n    styles.remove(this.$refs.container, { visibility: 'invisible' });\n    const { container, ...otherStyles } = this.$options.styles;\n\n    await Promise.all([\n      transition(this.$refs.container, {\n        from: { height: 0 },\n        active: container.active,\n        to: { height: `${this.$refs.content.offsetHeight}px` },\n      }).then(() => {\n        // Remove style only if the item has not been closed before the end\n        if (this.isOpen) {\n          styles.remove(this.$refs.content, { position: 'absolute' });\n        }\n\n        return Promise.resolve();\n      }),\n      ...Object.entries(otherStyles)\n        .filter(([refName]) => this.$refs[refName])\n        .map(([refName, { open, active, closed } = {}]) =>\n          transition(\n            this.$refs[refName],\n            {\n              from: closed,\n              active,\n              to: open,\n            },\n            'keep'\n          )\n        ),\n    ]);\n  }\n\n  /**\n   * Close an item.\n   * @return {void}\n   */\n  async close() {\n    if (!this.isOpen) {\n      return;\n    }\n\n    this.$log('close');\n    this.$emit('close');\n\n    this.isOpen = false;\n\n    const height = this.$refs.container.offsetHeight;\n    styles.add(this.$refs.content, { position: 'absolute' });\n    const { container, ...otherStyles } = this.$options.styles;\n\n    await Promise.all([\n      transition(this.$refs.container, {\n        from: { height: `${height}px` },\n        active: container.active,\n        to: { height: 0 },\n      }).then(() => {\n        // Add end styles only if the item has not been re-opened before the end\n        if (!this.isOpen) {\n          styles.add(this.$refs.container, { height: 0, visibility: 'invisible' });\n          this.updateAttributes(this.isOpen);\n        }\n        return Promise.resolve();\n      }),\n      ...Object.entries(otherStyles)\n        .filter(([refName]) => this.$refs[refName])\n        .map(([refName, { open, active, closed } = {}]) =>\n          transition(\n            this.$refs[refName],\n            {\n              from: open,\n              active,\n              to: closed,\n            },\n            'keep'\n          )\n        ),\n    ]);\n  }\n}\n","import Base from '../../abstracts/Base';\nimport AccordionItem from './AccordionItem';\n\n/**\n * Accordion class.\n */\nexport default class Accordion extends Base {\n  /**\n   * Accordion config.\n   * @return {Object}\n   */\n  get config() {\n    return {\n      name: 'Accordion',\n      autoclose: true,\n      item: null,\n      components: {\n        AccordionItem,\n      },\n    };\n  }\n\n  /**\n   * Init autoclose behavior on mounted.\n   * @return {void}\n   */\n  mounted() {\n    this.unbindMethods = this.$children.AccordionItem.map((item, index) => {\n      const unbindOpen = item.$on('open', () => {\n        this.$emit('open', item, index);\n        if (this.$options.autoclose) {\n          this.$children.AccordionItem.filter((el, i) => index !== i).forEach((it) => it.close());\n        }\n      });\n      const unbindClose = item.$on('close', () => {\n        this.$emit('close', item, index);\n      });\n\n      return () => {\n        unbindOpen();\n        unbindClose();\n      };\n    });\n  }\n\n  /**\n   * Destroy autoclose behavior on destroyed.\n   * @return {void}\n   */\n  destroyed() {\n    this.unbindMethods.forEach((unbind) => unbind());\n  }\n}\n","import Base from '../abstracts/Base';\nimport useResize from '../services/resize';\nimport nextFrame from '../utils/nextFrame';\n\n/**\n * MediaQuery component.\n *\n * <div data-component=\"MediaQuery\" data-active-breakpoints=\"l xl\">\n *   <div data-component=\"Foo\"></div>\n * </div>\n */\nexport default class MediaQuery extends Base {\n  /**\n   * Component's configuration.\n   *\n   * @return {Object}\n   */\n  get config() {\n    return {\n      name: 'MediaQuery',\n    };\n  }\n\n  /**\n   * Mounted hook.\n   */\n  mounted() {\n    this.test();\n    nextFrame(() => this.test());\n  }\n\n  /**\n   * Resized hook.\n   */\n  resized() {\n    this.test();\n  }\n\n  /**\n   * Get the first element child of the component, as it must be another Base component that could\n   * be either $mounted or $destroyed.\n   *\n   * @return {Base|Boolean}\n   */\n  get child() {\n    const child = this.$el.firstElementChild ? this.$el.firstElementChild.__base__ : false;\n\n    if (!child) {\n      throw new Error(\n        'The first and only child of the MediaQuery component must be another Base component.'\n      );\n    }\n\n    return child;\n  }\n\n  /**\n   * Get the current active breakpoint from the `useResize` service.\n   *\n   * @return {String}\n   */\n  get currentBreakpoint() {\n    return useResize().props().breakpoint;\n  }\n\n  /**\n   * Get a list of breakpoints in which the child component should be $mounted.\n   *\n   * @return {Array}\n   */\n  get activeBreakpoints() {\n    if (this.$el.dataset.activeBreakpoints) {\n      return this.$el.dataset.activeBreakpoints.split(' ');\n    }\n\n    return [];\n  }\n\n  /**\n   * Test if the child component should be either $mounted or $destroyed based on the current active\n   * breakpoint and the given list of breakpoints.\n   *\n   * @return {void}\n   */\n  test() {\n    const isInBreakpoints = this.activeBreakpoints.includes(this.currentBreakpoint);\n\n    if (isInBreakpoints && !this.child.$isMounted) {\n      this.child.$mount();\n      return;\n    }\n\n    if (!isInBreakpoints && this.child.$isMounted) {\n      this.child.$destroy();\n    }\n  }\n}\n","import keyCodes from './keyCodes';\n\nconst FOCUSABLE_ELEMENTS = [\n  'a[href]:not([tabindex^=\"-\"]):not([inert])',\n  'area[href]:not([tabindex^=\"-\"]):not([inert])',\n  'input:not([disabled]):not([inert])',\n  'select:not([disabled]):not([inert])',\n  'textarea:not([disabled]):not([inert])',\n  'button:not([disabled]):not([inert])',\n  'iframe:not([tabindex^=\"-\"]):not([inert])',\n  'audio:not([tabindex^=\"-\"]):not([inert])',\n  'video:not([tabindex^=\"-\"]):not([inert])',\n  '[contenteditable]:not([tabindex^=\"-\"]):not([inert])',\n  '[tabindex]:not([tabindex^=\"-\"]):not([inert])',\n];\n\n/**\n * Use a trap/untrap tabs logic.\n *\n * @return {Object} An object containing the trap and untrap methods.\n */\nexport default function useFocusTrap() {\n  let focusedBefore;\n\n  /**\n   * Save the current active element.\n   *\n   * @return {void}\n   */\n  function saveActiveElement() {\n    focusedBefore = document.activeElement;\n  }\n\n  /**\n   * Trap tab navigation inside the given element.\n   *\n   * @param  {HTMLElement} element The element in which to trap the tabulations.\n   * @param  {Event}       event   The keydown or keyup event.\n   * @return {void}\n   */\n  function trap(element, event) {\n    if (event.keyCode !== keyCodes.TAB) {\n      return;\n    }\n\n    // Save the previous focused element\n    if (!focusedBefore) {\n      focusedBefore = document.activeElement;\n    }\n\n    const focusableChildren = Array.from(element.querySelectorAll(FOCUSABLE_ELEMENTS.join(', ')));\n    const focusedItemIndex = focusableChildren.indexOf(document.activeElement);\n\n    if (!focusableChildren.length) {\n      return;\n    }\n\n    if (focusedItemIndex < 0) {\n      focusableChildren[0].focus();\n      event.preventDefault();\n    }\n\n    // If the SHIFT key is being pressed while tabbing (moving backwards) and\n    // the currently focused item is the first one, move the focus to the last\n    // focusable item from the dialog element\n    if (event.shiftKey && focusedItemIndex === 0) {\n      focusableChildren[focusableChildren.length - 1].focus();\n      event.preventDefault();\n    }\n\n    // If the SHIFT key is not being pressed (moving forwards) and the currently\n    // focused item is the last one, move the focus to the first focusable item\n    // from the dialog element\n    else if (!event.shiftKey && focusedItemIndex === focusableChildren.length - 1) {\n      focusableChildren[0].focus();\n      event.preventDefault();\n    }\n  }\n\n  /**\n   * Untrap the tab navigation.\n   *\n   * @return {void}\n   */\n  function untrap() {\n    if (focusedBefore && typeof focusedBefore.focus === 'function') {\n      focusedBefore.focus();\n      focusedBefore = null;\n    }\n  }\n\n  return { trap, untrap, saveActiveElement };\n}\n","import Base from '../abstracts/Base';\nimport transition from '../utils/css/transition';\nimport focusTrap from '../utils/focusTrap';\n\nconst { trap, untrap, saveActiveElement } = focusTrap();\n\n/**\n * Modal class.\n */\nexport default class Modal extends Base {\n  /**\n   * Modal options.\n   */\n  get config() {\n    return {\n      name: 'Modal',\n      move: false,\n      autofocus: '[autofocus]',\n      styles: {\n        modal: {\n          closed: {\n            opacity: 0,\n            pointerEvents: 'none',\n            visibility: 'hidden',\n          },\n        },\n      },\n    };\n  }\n\n  /**\n   * Open the modal on click on the `open` ref.\n   *\n   * @return {Function} The component's `open` method.\n   */\n  get onOpenClick() {\n    return this.open;\n  }\n\n  /**\n   * Close the modal on click on the `close` ref.\n   *\n   * @return {Function} The component's `close` method.\n   */\n  get onCloseClick() {\n    return this.close;\n  }\n\n  /**\n   * Close the modal on click on the `overlay` ref.\n   *\n   * @return {Function} The component's `close` method.\n   */\n  get onOverlayClick() {\n    return this.close;\n  }\n\n  /**\n   * Initialize the component's behaviours.\n   *\n   * @return {Modal} The current instance.\n   */\n  mounted() {\n    this.isOpen = false;\n    this.close();\n\n    if (this.$options.move) {\n      const target = document.querySelector(this.$options.move) || document.body;\n      const refsBackup = this.$refs;\n\n      this.refModalPlaceholder = document.createComment('');\n      this.refModalParentBackup = this.$refs.modal.parentElement || this.$el;\n      this.refModalParentBackup.insertBefore(this.refModalPlaceholder, this.$refs.modal);\n\n      this.refModalUnbindGetRefFilter = this.$on('get:refs', (refs) => {\n        Object.entries(refsBackup).forEach(([key, ref]) => {\n          if (!refs[key]) {\n            refs[key] = ref;\n          }\n        });\n      });\n      target.appendChild(this.$refs.modal);\n    }\n\n    return this;\n  }\n\n  /**\n   * Unbind all events on destroy.\n   *\n   * @return {Modal} The Modal instance.\n   */\n  destroyed() {\n    this.close();\n\n    if (this.$options.move) {\n      this.refModalParentBackup.insertBefore(this.$refs.modal, this.refModalPlaceholder);\n      this.refModalUnbindGetRefFilter();\n      this.refModalPlaceholder.remove();\n      delete this.refModalPlaceholder;\n      delete this.refModalParentBackup;\n      delete this.refModalUnbindGetRefFilter;\n    }\n\n    return this;\n  }\n\n  /**\n   * Close the modal on `ESC` and trap the tabulation.\n   *\n   * @param  {KeyboardEvent} options.event  The original keyboard event\n   * @param  {Boolean}       options.isUp   Is it a keyup event?\n   * @param  {Boolean}       options.isDown Is it a keydown event?\n   * @param  {Boolean}       options.ESC    Is it the ESC key?\n   * @return {void}\n   */\n  keyed({ event, isUp, isDown, ESC }) {\n    if (!this.isOpen) {\n      return;\n    }\n\n    if (isDown) {\n      trap(this.$refs.modal, event);\n    }\n\n    if (ESC && isUp) {\n      this.close();\n    }\n  }\n\n  /**\n   * Open the modal.\n   *\n   * @return {Modal} The Modal instance.\n   */\n  async open() {\n    if (this.isOpen) {\n      return Promise.resolve(this);\n    }\n\n    this.$refs.modal.setAttribute('aria-hidden', 'false');\n    document.documentElement.style.overflow = 'hidden';\n\n    this.isOpen = true;\n    this.$emit('open');\n\n    return Promise.all(\n      Object.entries(this.$options.styles).map(([refName, { open, active, closed } = {}]) =>\n        transition(\n          this.$refs[refName],\n          {\n            from: closed,\n            active,\n            to: open,\n          },\n          'keep'\n        )\n      )\n    ).then(() => {\n      if (this.$options.autofocus && this.$refs.modal.querySelector(this.$options.autofocus)) {\n        saveActiveElement();\n        this.$refs.modal.querySelector(this.$options.autofocus).focus();\n      }\n      return Promise.resolve(this);\n    });\n  }\n\n  /**\n   * Close the modal.\n   *\n   * @return {Modal} The Modal instance.\n   */\n  async close() {\n    if (!this.isOpen) {\n      return Promise.resolve(this);\n    }\n\n    this.$refs.modal.setAttribute('aria-hidden', 'true');\n    document.documentElement.style.overflow = '';\n\n    this.isOpen = false;\n    untrap();\n    this.$emit('close');\n\n    return Promise.all(\n      Object.entries(this.$options.styles).map(([refName, { open, active, closed } = {}]) =>\n        transition(\n          this.$refs[refName],\n          {\n            from: open,\n            active,\n            to: closed,\n          },\n          'keep'\n        )\n      )\n    ).then(() => Promise.resolve(this));\n  }\n}\n","import Base from '../abstracts/Base';\nimport transition from '../utils/css/transition';\n\n/**\n * Tabs class.\n */\nexport default class Tabs extends Base {\n  /**\n   * Tabs options.\n   */\n  get config() {\n    return {\n      name: 'Tabs',\n      styles: {\n        content: {\n          closed: {\n            position: 'absolute',\n            opacity: 0,\n            pointerEvents: 'none',\n            visibility: 'hidden',\n          },\n        },\n      },\n    };\n  }\n\n  /**\n   * Initialize the component's behaviours.\n   *\n   * @return {Tabs} The current instance.\n   */\n  mounted() {\n    this.items = this.$refs.btn.map((btn, index) => {\n      const id = `${this.$id}-${index}`;\n      const content = this.$refs.content[index];\n      btn.setAttribute('id', id);\n      content.setAttribute('aria-labelledby', id);\n\n      const item = { btn, content, isEnabled: index > 0 };\n      if (index > 0) {\n        this.disableItem(item);\n      } else {\n        this.enableItem(item);\n      }\n      return item;\n    });\n\n    return this;\n  }\n\n  /**\n   * Switch tab on button click.\n   *\n   * @param  {Event}  event The click event object.\n   * @param  {Number} index The index of the clicked button.\n   * @return {void}\n   */\n  onBtnClick(event, index) {\n    this.items.forEach((item, i) => {\n      if (i !== index) {\n        this.disableItem(item);\n      }\n    });\n\n    this.enableItem(this.items[index]);\n  }\n\n  /**\n   * Enable the given tab and its associated content.\n   *\n   * @param  {HTMLElement} btn     The tab element.\n   * @param  {HTMLElement} content The content element.\n   * @return {Tabs}                The Tabs instance.\n   */\n  async enableItem(item) {\n    if (!item || item.isEnabled) {\n      return Promise.resolve(this);\n    }\n\n    item.isEnabled = true;\n    const { btn, content } = item;\n    const btnStyles = this.$options.styles.btn || {};\n    const contentStyles = this.$options.styles.content || {};\n\n    content.setAttribute('aria-hidden', 'false');\n    this.$emit('enable', item);\n\n    return Promise.all([\n      transition(\n        btn,\n        {\n          from: btnStyles.closed,\n          active: btnStyles.active,\n          to: btnStyles.open,\n        },\n        'keep'\n      ),\n      transition(\n        content,\n        {\n          from: contentStyles.closed,\n          active: contentStyles.active,\n          to: contentStyles.open,\n        },\n        'keep'\n      ),\n    ]).then(() => Promise.resolve(this));\n  }\n\n  /**\n   * Disable the given tab and its associated content.\n   *\n   * @param  {HTMLElement} btn     The tab element.\n   * @param  {HTMLElement} content The content element.\n   * @return {Tabs}                The Tabs instance.\n   */\n  async disableItem(item) {\n    if (!item || !item.isEnabled) {\n      return Promise.resolve(this);\n    }\n\n    item.isEnabled = false;\n    const { btn, content } = item;\n    const btnStyles = this.$options.styles.btn || {};\n    const contentStyles = this.$options.styles.content || {};\n\n    content.setAttribute('aria-hidden', 'true');\n    this.$emit('disable', item);\n\n    return Promise.all([\n      transition(\n        btn,\n        {\n          from: btnStyles.open,\n          active: btnStyles.active,\n          to: btnStyles.closed,\n        },\n        'keep'\n      ),\n      transition(\n        content,\n        {\n          from: contentStyles.open,\n          active: contentStyles.active,\n          to: contentStyles.closed,\n        },\n        'keep'\n      ),\n    ]).then(() => Promise.resolve(this));\n  }\n}\n","import useResize from '../services/resize';\n\n/**\n * Test the breakpoins of the given Base instance and return the hook to call.\n *\n * @param  {Base}           instance The component's instance.\n * @return {String|Boolean}          The action to call ($mount|$destroy) or false.\n */\nfunction testBreakpoints(breakpoints) {\n  const { breakpoint } = useResize().props();\n  breakpoints.forEach(([breakpointKeys, instance]) => {\n    if (breakpointKeys.includes(breakpoint)) {\n      instance.$mount();\n    } else {\n      instance.$destroy();\n    }\n  });\n}\n\n/**\n * A cache object to hold each Base sub-instances.\n * @type {Object}\n */\nconst instances = {};\n\n/**\n * BreakpointManager class.\n */\nexport default (BaseClass, breakpoints) => {\n  if (!Array.isArray(breakpoints)) {\n    throw new Error('[withBreakpointManager] The `breakpoints` parameter must be an array.');\n  }\n\n  if (breakpoints.length < 2) {\n    throw new Error('[withBreakpointManager] You must define at least 2 breakpoints.');\n  }\n\n  const { add, props } = useResize();\n\n  // Do nothing if no breakpoint has been defined.\n  // @see https://js-toolkit.meta.fr/services/resize.html#breakpoint\n  if (!props().breakpoint) {\n    throw new Error(`The \\`BreakpointManager\\` class requires breakpoints to be defined.`);\n  }\n\n  return class BreakpointManager extends BaseClass {\n    /**\n     * Watch for the document resize to test the breakpoints.\n     * @param  {HTMLElement} element The component's root element.\n     * @return {BreakpointManager}          The current instance.\n     */\n    constructor(element) {\n      super(element);\n\n      instances[this.$id] = breakpoints.map(([bk, ComponentClass]) => {\n        // eslint-disable-next-line no-underscore-dangle\n        ComponentClass.prototype.__isChild__ = true;\n        const instance = new ComponentClass(this.$el);\n        Object.defineProperty(instance, '$parent', { get: () => this });\n        return [bk, instance];\n      });\n\n      add(`BreakpointManager-${this.$id}`, () => {\n        testBreakpoints(instances[this.$id]);\n      });\n\n      return this;\n    }\n\n    /**\n     * Override the default $mount method to prevent component's from being\n     * mounted when they should not.\n     * @return {Base} The Base instance.\n     */\n    $mount() {\n      testBreakpoints(instances[this.$id]);\n\n      return super.$mount();\n    }\n\n    /**\n     * Destroy all instances when the main one is destroyed.\n     * @return {Base} The Base instance.\n     */\n    $destroy() {\n      if (Array.isArray(instances[this.$id])) {\n        instances[this.$id].forEach(([, instance]) => {\n          instance.$destroy();\n        });\n      }\n\n      return super.$destroy();\n    }\n  };\n};\n","import useResize from '../services/resize';\n\n/**\n * Test the breakpoins of the given Base instance and return the hook to call.\n *\n * @param  {BreakpointObserver} instance The component's instance.\n * @return {Sring}                       The action to trigger.\n */\nfunction testBreakpoints(instance, breakpoint = useResize().props().breakpoint) {\n  const { activeBreakpoints, inactiveBreakpoints } = instance.$options;\n  const isInActiveBreakpoint =\n    activeBreakpoints && activeBreakpoints.split(' ').includes(breakpoint);\n  const isInInactiveBreakpoint =\n    inactiveBreakpoints && inactiveBreakpoints.split(' ').includes(breakpoint);\n\n  if (\n    (activeBreakpoints && isInActiveBreakpoint) ||\n    (inactiveBreakpoints && !isInInactiveBreakpoint)\n  ) {\n    return '$mount';\n  }\n\n  return '$destroy';\n}\n\n/**\n * Test if the given instance is configured for breakpoints.\n * @param  {Base}    instance A Base class instance.\n * @return {Boolean}          True if configured correctly, false otherwise.\n */\nfunction hasBreakpointConfiguration(instance) {\n  const { activeBreakpoints, inactiveBreakpoints } = instance.$options;\n  return Boolean(activeBreakpoints || inactiveBreakpoints);\n}\n\n/**\n * Test if the given instance has a conflicting configuration for breakpoints.\n * @param  {Base} instance A Base class instance.\n * @return {void}\n */\nfunction testConflictingBreakpointConfiguration(instance) {\n  const { activeBreakpoints, inactiveBreakpoints, name } = instance.$options;\n  if (activeBreakpoints && inactiveBreakpoints) {\n    throw new Error(\n      `[${name}] Incorrect configuration: the \\`activeBreakpoints\\` and \\`inactiveBreakpoints\\` are not compatible.`\n    );\n  }\n}\n\n/**\n * BreakpointObserver class.\n */\nexport default (BaseClass) =>\n  class BreakpointObserver extends BaseClass {\n    /**\n     * Watch for the document resize to test the breakpoints.\n     * @param  {HTMLElement} element The component's root element.\n     * @return {BreakpointObserver}          The current instance.\n     */\n    constructor(element) {\n      super(element);\n\n      const { add, has, remove, props } = useResize();\n      const { name } = this.$options;\n\n      // Do nothing if no breakpoint has been defined.\n      // @see https://js-toolkit.meta.fr/services/resize.html#breakpoint\n      if (!props().breakpoint) {\n        throw new Error(\n          `[${name}] The \\`BreakpointObserver\\` class requires breakpoints to be defined.`\n        );\n      }\n\n      const key = `BreakpointObserver-${this.$id}`;\n\n      // Watch change on the `data-options` attribute to emit the `set:options` event.\n      const mutationObserver = new MutationObserver(([mutation]) => {\n        if (mutation.type === 'attributes' && mutation.attributeName === 'data-options') {\n          // Stop here silently when no breakpoint configuration given.\n          if (!hasBreakpointConfiguration(this)) {\n            this.$mount();\n            remove(key);\n            return;\n          }\n\n          testConflictingBreakpointConfiguration(this);\n\n          if (!has(key)) {\n            add(key, ({ breakpoint }) => {\n              const action = testBreakpoints(this, breakpoint);\n              this[action]();\n            });\n          }\n        }\n      });\n      mutationObserver.observe(this.$el, { attributes: true });\n\n      // Stop here silently when no breakpoint configuration given.\n      if (!hasBreakpointConfiguration(this)) {\n        return this;\n      }\n\n      testConflictingBreakpointConfiguration(this);\n      add(key, ({ breakpoint }) => {\n        const action = testBreakpoints(this, breakpoint);\n        this[action]();\n      });\n\n      return this;\n    }\n\n    /**\n     * Override the default $mount method to prevent component's from being\n     * mounted when they should not.\n     * @return {BreakpointObserver} The component's instance.\n     */\n    $mount() {\n      // Execute normal behavior when no breakpoint configuration given.\n      if (!hasBreakpointConfiguration(this)) {\n        return super.$mount();\n      }\n\n      const action = testBreakpoints(this);\n      if (action === '$mount') {\n        return super.$mount();\n      }\n\n      return this;\n    }\n  };\n","import { debug } from '../abstracts/Base/utils';\n\n/**\n * Create an array of number between 0 and 1 from the given length.\n * @param  {Number} length The length of the array.\n * @return {Array}        An array of number.\n */\nfunction createArrayOfNumber(length) {\n  return [...new Array(length + 1)].map((val, index) => index / length);\n}\n\n/**\n * IntersectionObserver decoration.\n */\nexport default (BaseClass, defaultOptions = { threshold: createArrayOfNumber(100) }) =>\n  class extends BaseClass {\n    /**\n     * Add the `intersected` method to the list of method to exclude from the `autoBind` call.\n     */\n    get _excludeFromAutoBind() {\n      return [...(super._excludeFromAutoBind || []), 'intersected'];\n    }\n\n    /**\n     * Create an observer when the class in instantiated.\n     *\n     * @param  {HTMLElement} element The component's root element.\n     * @return {Base}                The class instace.\n     */\n    constructor(element) {\n      super(element);\n\n      if (!this.intersected || typeof this.intersected !== 'function') {\n        throw new Error('[withIntersectionObserver] The `intersected` method must be defined.');\n      }\n\n      this.$observer = new IntersectionObserver(\n        (entries) => {\n          debug(this, 'intersected', entries);\n          this.$emit('intersected', entries);\n          this.intersected(entries);\n        },\n        { ...defaultOptions, ...(this.$options.intersectionObserver || {}) }\n      );\n\n      if (this.$isMounted) {\n        this.$observer.observe(this.$el);\n      }\n\n      this.$on('mounted', () => {\n        this.$observer.observe(this.$el);\n      });\n\n      this.$on('destroyed', () => {\n        this.$observer.unobserve(this.$el);\n      });\n\n      return this;\n    }\n  };\n","/**\n * Smooth step from currentValue to targetValue\n *\n * @param  {Int} targetValue we want to reech\n * @param  {Int} currentValue\n * @param  {Int} speed to reech target value\n * @return {Int}\n */\nexport default function damp(targetValue, currentValue, speed = 0.5) {\n  const value = currentValue + (targetValue - currentValue) * speed;\n  return Math.abs(targetValue - currentValue) < 0.001 ? targetValue : value;\n}\n","/**\n * Interpolate the ratio between a given interval.\n *\n * @param  {Number} min   The interval minimum value.\n * @param  {Number} max   The inverval maximum value.\n * @param  {Number} ratio The ratio to get.\n * @return {Number}       The value between min and max corresponding to ratio.\n */\nexport default function lerp(min, max, ratio) {\n  return (1 - ratio) * min + ratio * max;\n}\n","/**\n * Maps the value from one range of [inputMin..inputMax] to another range of [outputMin..outputMax].\n *\n * @param  {Number} value     The value to map.\n * @param  {Number} inputMin  The input's minimum value.\n * @param  {Number} inputMax  The input's maximum value.\n * @param  {Number} ouptutMin The output's minimum value.\n * @param  {Number} outputMax The intput's maximum value.\n * @return {Number}           The input value mapped to the output range.\n */\nexport default function map(value, inputMin, inputMax, outputMin, outputMax) {\n  return ((value - inputMin) * (outputMax - outputMin)) / (inputMax - inputMin) + outputMin;\n}\n","/**\n * Round a value with a given number of decimals.\n *\n * @param  {Number} value    The number to round.\n * @param  {Number} decimals The number of decimals to keep.\n * @return {Number}          A rounded number to the given decimals length.\n */\nexport default function round(value, decimals = 0) {\n  return Number(value.toFixed(decimals));\n}\n"],"names":["getAllProperties","object","props","proto","Object","getPrototypeOf","prototype","getOwnPropertyNames","map","name","reduce","acc","val","autoBind","instance","include","exclude","filter","key","match","pattern","test","some","forEach","descriptor","getOwnPropertyDescriptor","value","bind","EventManager","_events","$on","event","listener","Array","isArray","push","$off","index","indexOf","splice","$emit","args","apply","$once","handler","debug","$options","window","console","log","config","hasMethod","obj","callMethod","method","$isMounted","call","getChild","el","ComponentClass","parent","__base__","__isBase__","defineProperty","child","get","asyncComponent","then","module","ResolvedClass","default","__isAsync__","getChildren","element","components","children","entries","selector","elements","from","querySelectorAll","length","getOptions","options","dataset","JSON","parse","err","Error","merge","setOptions","newOptions","stringify","getRefs","allRefs","childrenRefs","ref","includes","refs","$refs","$ref","refName","$realRef","endsWith","replace","mountComponent","component","$mount","mountComponents","$children","values","$child","destroyComponent","$destroy","destroyComponents","Service","constructor","callbacks","Map","isInit","init","kill","add","callback","has","size","set","remove","delete","trigger","throttle","fn","delay","lastCall","now","Date","getTime","debounce","timeout","clearTimeout","setTimeout","getRaf","requestAnimationFrame","nextFrame","raf","Promise","resolve","Raf","isTicking","loop","time","performance","Pointer","isDown","y","innerHeight","yLast","x","innerWidth","xLast","useRaf","hasRaf","debounced","updateValues","downHandler","upHandler","document","documentElement","addEventListener","once","passive","removeEventListener","touches","clientY","clientX","changed","last","delta","progress","max","pointer","Resize","canUseResizeObserver","resizeObserver","ResizeObserver","observe","disconnect","width","height","ratio","orientation","breakpointElement","breakpoint","breakpoints","querySelector","getComputedStyle","getPropertyValue","split","resize","Scroll","pageYOffset","pageXOffset","scrollingElement","body","scrollWidth","scrollHeight","scroll","ENTER","SPACE","TAB","ESC","LEFT","UP","RIGHT","DOWN","Key","triggered","previousEvent","keys","keyCodes","code","keyCode","type","direction","isUp","initService","service","$id","bindServices","unbindMethods","useScroll","useResize","usePointer","useKey","loadedHandler","bindRootEvents","eventMethods","eventMethod","eventName","toLowerCase","$el","bindRefsEvents","$refOrRefs","refEventMethod","c","toUpperCase","startsWith","unbindMethod","bindChildrenEvents","childName","childEventMethod","bindEvents","ROOT_EVENT_REGEX","REFS_CHILDREN_EVENT_REGEX","root","refsOrChildren","Base","defineProperties","nanoid","writable","configurable","_excludeFromAutoBind","__isChild__","$log","$update","$terminate","defineComponent","methods","hooks","Component","allowedHooks","filteredHooks","join","createBase","elementOrSelector","isObject","toString","setStyles","styles","prop","style","classNames","setClasses","className","classList","toggle","setClassesOrStyles","classesOrStyles","classes","testTransition","transitionDuration","start","__isTransitioning__","active","next","hasTransition","__transitionEndHandler__","to","end","mode","transition","endMode","AccordionItem","isOpen","container","open","closed","mounted","$parent","item","btn","setAttribute","contentId","content","updateAttributes","visibility","otherStyles","onBtnClick","close","all","offsetHeight","position","Accordion","autoclose","unbindOpen","i","it","unbindClose","destroyed","unbind","MediaQuery","resized","firstElementChild","currentBreakpoint","activeBreakpoints","isInBreakpoints","FOCUSABLE_ELEMENTS","useFocusTrap","focusedBefore","saveActiveElement","activeElement","trap","focusableChildren","focusedItemIndex","focus","preventDefault","shiftKey","untrap","focusTrap","Modal","move","autofocus","modal","opacity","pointerEvents","onOpenClick","onCloseClick","onOverlayClick","target","refsBackup","refModalPlaceholder","createComment","refModalParentBackup","parentElement","insertBefore","refModalUnbindGetRefFilter","appendChild","keyed","overflow","Tabs","items","id","isEnabled","disableItem","enableItem","btnStyles","contentStyles","testBreakpoints","breakpointKeys","instances","BaseClass","BreakpointManager","bk","inactiveBreakpoints","isInActiveBreakpoint","isInInactiveBreakpoint","hasBreakpointConfiguration","Boolean","testConflictingBreakpointConfiguration","BreakpointObserver","mutationObserver","MutationObserver","mutation","attributeName","action","attributes","createArrayOfNumber","defaultOptions","threshold","intersected","$observer","IntersectionObserver","intersectionObserver","unobserve","damp","targetValue","currentValue","speed","Math","abs","lerp","min","inputMin","inputMax","outputMin","outputMax","round","decimals","Number","toFixed"],"mappings":"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"}