{"version":3,"sources":["../../../src/abstracts/Base/children.js"],"names":["getChild","el","ComponentClass","parent","__base__","__isBase__","Object","defineProperty","prototype","value","child","get","asyncComponent","then","module","ResolvedClass","default","__isAsync__","getComponentElements","nameOrSelector","elements","document","querySelectorAll","length","Array","from","getChildren","instance","element","components","children","entries","reduce","acc","name","map","filter","$emit"],"mappings":"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","sourcesContent":["/**\n * Get a child component.\n *\n * @param  {HTMLElement}  el             The root element of the child component.\n * @param  {Base|Promise} ComponentClass A Base class or a Promise for async components.\n * @param  {Base}         parent         The parent component instance.\n * @return {Base|Promise}                A Base instance or a Promise resolving to a Base instance.\n */\nfunction getChild(el, ComponentClass, parent) {\n  // Return existing instance if it exists\n  if (el.__base__) {\n    return el.__base__;\n  }\n\n  // Return a new instance if the component class is a child of the Base class\n  if (ComponentClass.__isBase__) {\n    Object.defineProperty(ComponentClass.prototype, '__isChild__', { value: true });\n    const child = new ComponentClass(el);\n    Object.defineProperty(child, '$parent', { get: () => parent });\n    return child;\n  }\n\n  // Resolve async components\n  const asyncComponent = ComponentClass().then((module) => {\n    const ResolvedClass = module.default ? module.default : module;\n    Object.defineProperty(ResolvedClass.prototype, '__isChild__', { value: true });\n    const child = new ResolvedClass(el);\n    Object.defineProperty(child, '$parent', { get: () => parent });\n    return child;\n  });\n\n  asyncComponent.__isAsync__ = true;\n\n  return asyncComponent;\n}\n\n/**\n * Get a list of elements based on the name of a component.\n * @param  {String}         nameOrSelector The name or selector to used for this component.\n * @return {Array<Element>}                A list of elements on which the component should be mounted.\n */\nexport function getComponentElements(nameOrSelector) {\n  let elements = document.querySelectorAll(`[data-component=\"${nameOrSelector}\"]`);\n\n  // If no child component found with the default selector, try a classic DOM selector\n  if (elements.length === 0) {\n    elements = document.querySelectorAll(nameOrSelector);\n  }\n\n  return Array.from(elements);\n}\n\n/**\n *\n * @param  {Base}        instance   The component's instance.\n * @param  {HTMLElement} element    The component's root element\n * @param  {Object}      components The children components' classes\n * @return {null|Object}            Returns `null` if no child components are defined or an object of all child component instances\n */\nexport function getChildren(instance, element, components) {\n  const children = Object.entries(components).reduce((acc, [name, ComponentClass]) => {\n    const elements = getComponentElements(name);\n\n    if (elements.length === 0) {\n      return acc;\n    }\n\n    acc[name] = elements\n      .map((el) => getChild(el, ComponentClass, instance))\n      // Filter out terminated children\n      .filter((el) => el !== 'terminated');\n\n    if (acc[name].length === 0) {\n      delete acc[name];\n    }\n\n    return acc;\n  }, {});\n\n  instance.$emit('get:children', children);\n  return children;\n}\n\nexport default {\n  getChildren,\n};\n"],"file":"children.js"}