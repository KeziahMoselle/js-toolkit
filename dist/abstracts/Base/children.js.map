{"version":3,"sources":["../../../src/abstracts/Base/children.js"],"names":["getChild","el","ComponentClass","parent","__base__","__isBase__","Object","defineProperty","prototype","value","child","get","asyncComponent","then","module","ResolvedClass","default","__isAsync__","getChildren","instance","element","components","children","entries","reduce","acc","name","selector","elements","Array","from","querySelectorAll","length","map","filter","$emit"],"mappings":"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","sourcesContent":["/**\n * Get a child component.\n *\n * @param  {HTMLElement}  el             The root element of the child component.\n * @param  {Base|Promise} ComponentClass A Base class or a Promise for async components.\n * @param  {Base}         parent         The parent component instance.\n * @return {Base|Promise}                A Base instance or a Promise resolving to a Base instance.\n */\nfunction getChild(el, ComponentClass, parent) {\n  // Return existing instance if it exists\n  if (el.__base__) {\n    return el.__base__;\n  }\n\n  // Return a new instance if the component class is a child of the Base class\n  if (ComponentClass.__isBase__) {\n    Object.defineProperty(ComponentClass.prototype, '__isChild__', { value: true });\n    const child = new ComponentClass(el);\n    Object.defineProperty(child, '$parent', { get: () => parent });\n    return child;\n  }\n\n  // Resolve async components\n  const asyncComponent = ComponentClass().then((module) => {\n    const ResolvedClass = module.default ? module.default : module;\n    Object.defineProperty(ResolvedClass.prototype, '__isChild__', { value: true });\n    const child = new ResolvedClass(el);\n    Object.defineProperty(child, '$parent', { get: () => parent });\n    return child;\n  });\n\n  asyncComponent.__isAsync__ = true;\n\n  return asyncComponent;\n}\n\n/**\n *\n * @param  {Base}        instance   The component's instance.\n * @param  {HTMLElement} element    The component's root element\n * @param  {Object}      components The children components' classes\n * @return {null|Object}            Returns `null` if no child components are defined or an object of all child component instances\n */\nexport function getChildren(instance, element, components) {\n  const children = Object.entries(components).reduce((acc, [name, ComponentClass]) => {\n    const selector = `[data-component=\"${name}\"]`;\n    let elements = Array.from(element.querySelectorAll(selector));\n\n    // If no child component found with the default selector, the name must be a DOM selector\n    if (elements.length === 0) {\n      elements = Array.from(element.querySelectorAll(name));\n    }\n\n    if (elements.length === 0) {\n      return acc;\n    }\n\n    acc[name] = elements\n      .map((el) => getChild(el, ComponentClass, instance))\n      // Filter out terminated children\n      .filter((el) => el !== 'terminated');\n\n    if (acc[name].length === 0) {\n      delete acc[name];\n    }\n\n    return acc;\n  }, {});\n\n  instance.$emit('get:children', children);\n  return children;\n}\n\nexport default {\n  getChildren,\n};\n"],"file":"children.js"}