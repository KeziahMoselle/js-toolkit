{"version":3,"sources":["../../src/abstracts/Base.js"],"names":["hasMethod","obj","name","debug","instance","args","$options","window","console","log","apply","config","getRefs","element","allRefs","Array","from","querySelectorAll","childrenRefs","elements","filter","ref","includes","refs","reduce","$refs","$ref","refName","dataset","$realRef","__base__","endsWith","replace","isArray","push","$emit","getChildren","components","children","Object","entries","acc","ComponentClass","selector","length","map","el","__isBase__","defineProperty","prototype","value","child","get","asyncComponent","then","module","ResolvedClass","default","__isAsync__","getOptions","options","JSON","parse","err","Error","setOptions","newOptions","stringify","call","method","$isMounted","mountComponent","component","$mount","mountComponents","$children","values","forEach","$child","destroyComponent","$destroy","destroyComponents","initService","service","add","remove","$id","Base","$el","defineProperties","writable","unbindMethods","$on","loadedHandler","event","addEventListener","removeEventListener","useScroll","useResize","useRaf","usePointer","useKey","eventMethods","startsWith","$refOrRefs","refEventMethod","c","toUpperCase","eventMethod","index","eventName","toLowerCase","handler","exclude","__isChild__","EventManager"],"mappings":"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","sourcesContent":["/* eslint-disable no-underscore-dangle */\nimport nanoid from 'nanoid/non-secure';\nimport merge from 'deepmerge';\nimport autoBind from '../utils/object/autoBind';\nimport getAllProperties from '../utils/object/getAllProperties';\nimport EventManager from './EventManager';\nimport usePointer from '../services/pointer';\nimport useRaf from '../services/raf';\nimport useResize from '../services/resize';\nimport useScroll from '../services/scroll';\nimport useKey from '../services/key';\n\n/**\n * Test if an object has a method.\n *\n * @param  {Object}  obj The object to test\n * @param  {String}  fn  The method's name\n * @return {Boolean}\n */\nfunction hasMethod(obj, name) {\n  return typeof obj[name] === 'function';\n}\n\n/**\n * Verbose debug for the component.\n *\n * @param  {...any} args The arguments passed to the method\n * @return {void}\n */\nfunction debug(instance, ...args) {\n  return instance.$options.debug\n    ? window.console.log.apply(window, [instance.config.name, ...args])\n    : () => {};\n}\n\n/**\n * Get all refs of a component.\n *\n * @param  {Base}        instance The component's instance.\n * @param  {HTMLElement} element  The component's root element.\n * @return {Object}               Return an object containing all the component's refs.\n */\nfunction getRefs(instance, element) {\n  const allRefs = Array.from(element.querySelectorAll(`[data-ref]`));\n  const childrenRefs = Array.from(element.querySelectorAll(`:scope [data-component] [data-ref]`));\n  const elements = allRefs.filter(ref => !childrenRefs.includes(ref));\n\n  const refs = elements.reduce(($refs, $ref) => {\n    let refName = $ref.dataset.ref;\n    const $realRef = $ref.__base__ ? $ref.__base__ : $ref;\n\n    // Cast the ref as an array if its name ends with `[]`\n    if (refName.endsWith('[]')) {\n      refName = refName.replace(/\\[\\]$/, '');\n\n      if (!$refs[refName]) {\n        $refs[refName] = [];\n      }\n    }\n\n    if ($refs[refName]) {\n      if (Array.isArray($refs[refName])) {\n        $refs[refName].push($realRef);\n      } else {\n        $refs[refName] = [$refs[refName], $realRef];\n      }\n    } else {\n      $refs[refName] = $realRef;\n    }\n\n    return $refs;\n  }, {});\n\n  instance.$emit('get:refs', refs);\n  return refs;\n}\n\n/**\n *\n * @param  {Base}        instance   The component's instance.\n * @param  {HTMLElement} element    The component's root element\n * @param  {Object}      components The children components' classes\n * @return {null|Object}            Returns `null` if no child components are defined or an object of all child component instances\n */\nfunction getChildren(instance, element, components) {\n  const children = Object.entries(components).reduce((acc, [name, ComponentClass]) => {\n    const selector = `[data-component=\"${name}\"]`;\n    let elements = Array.from(element.querySelectorAll(selector));\n\n    // If no child component found with the default selector, the name must be a DOM selector\n    if (elements.length === 0) {\n      elements = Array.from(element.querySelectorAll(name));\n    }\n\n    if (elements.length === 0) {\n      return acc;\n    }\n\n    acc[name] = elements.map(el => {\n      // Return existing instance if it exists\n      if (el.__base__) {\n        return el.__base__;\n      }\n\n      // Return a new instance if the component class is a child of the Base class\n      if (ComponentClass.__isBase__) {\n        Object.defineProperty(ComponentClass.prototype, '__isChild__', { value: true });\n        const child = new ComponentClass(el);\n        Object.defineProperty(child, '$parent', { get: () => instance });\n        return child;\n      }\n\n      // Resolve async components\n      const asyncComponent = ComponentClass().then(module => {\n        const ResolvedClass = module.default ? module.default : module;\n        Object.defineProperty(ResolvedClass.prototype, '__isChild__', { value: true });\n        const child = new ResolvedClass(el);\n        Object.defineProperty(child, '$parent', { get: () => instance });\n        return child;\n      });\n\n      asyncComponent.__isAsync__ = true;\n\n      return asyncComponent;\n    });\n\n    return acc;\n  }, {});\n\n  instance.$emit('get:children', children);\n  return children;\n}\n\n/**\n * Get a component's options.\n *\n * @param  {Base}        instance The component's instance.\n * @param  {HTMLElement} element  The component's root element.\n * @param  {Object}      config   The component's default config.\n * @return {Object}               The component's merged options.\n */\nfunction getOptions(instance, element, config) {\n  let options = {};\n  if (element.dataset.options) {\n    try {\n      options = JSON.parse(element.dataset.options);\n    } catch (err) {\n      throw new Error('Can not parse the `data-options` attribute. Is it a valid JSON string?');\n    }\n  }\n\n  options = merge(config, options);\n  instance.$emit('get:options', options);\n  return options;\n}\n\n/**\n * Set a component instance options.\n *\n * @param {Base}        instance   The component's instance.\n * @param {HTMLElement} element    The component's root element.\n * @param {Object}      newOptions The new options object.\n */\nfunction setOptions(instance, element, newOptions) {\n  let options = {};\n  if (element.dataset.options) {\n    try {\n      options = JSON.parse(element.dataset.options);\n    } catch (err) {\n      throw new Error('Can not parse the `data-options` attribute. Is it a valid JSON string?');\n    }\n  }\n  options = merge(options, newOptions);\n  element.dataset.options = JSON.stringify(options);\n}\n\n/**\n * Call the given method while applying the given arguments.\n *\n * @param {String} method The method to call\n * @param {...any} args   The arguments to pass to the method\n */\nfunction call(instance, method, ...args) {\n  debug(instance, 'call', method, ...args);\n\n  // Prevent duplicate call of `mounted` and `destroyed`\n  // methods based on the component status\n  if (\n    (method === 'destroyed' && !instance.$isMounted) ||\n    (method === 'mounted' && instance.$isMounted)\n  ) {\n    debug(instance, 'not', method, 'because the method has already been triggered once.');\n    return instance;\n  }\n\n  instance.$emit(method, ...args);\n\n  // We always emit an event, but we do not call the method if it does not exist\n  if (!hasMethod(instance, method)) {\n    return instance;\n  }\n\n  instance[method].call(instance, ...args);\n  debug(instance, method, instance, ...args);\n\n  return instance;\n}\n\n/**\n * Mount a given component which might be async.\n *\n * @param  {Base|Promise} component The component to mount.\n * @return {void}\n */\nfunction mountComponent(component) {\n  if (component.__isAsync__) {\n    component.then(instance => instance.$mount());\n  } else {\n    component.$mount();\n  }\n}\n\n/**\n * Mount children components of a given instance.\n *\n * @param  {Base} instance The parent component's instance.\n * @return {void}\n */\nfunction mountComponents(instance) {\n  if (!instance.$children) {\n    return;\n  }\n\n  debug(instance, 'mountComponents', instance.$children);\n\n  Object.values(instance.$children).forEach($child => {\n    $child.forEach(mountComponent);\n  });\n}\n\n/**\n * Destroy a given component which might be async.\n *\n * @param  {Base|Promise} component The component to destroy.\n * @return {void}\n */\nfunction destroyComponent(component) {\n  if (component.__isAsync__) {\n    component.then(instance => instance.$destroy());\n  } else {\n    component.$destroy();\n  }\n}\n\n/**\n * Destroy children components of a given instance.\n *\n * @param  {Base} instance The parent component's instance.\n * @return {void}\n */\nfunction destroyComponents(instance) {\n  if (!instance.$children) {\n    return;\n  }\n  debug(instance, 'destroyComponents', instance.$children);\n\n  Object.values(instance.$children).forEach($child => {\n    $child.forEach(destroyComponent);\n  });\n}\n\n/**\n * Init the given service and bind it to the given instance.\n *\n * @param  {Base}     instance The Base instance.\n * @param  {String}   method   The instance to test for binding\n * @param  {Function} service  The service `use...` function\n * @return {Function}          A function to unbind the service\n */\nfunction initService(instance, method, service) {\n  if (!hasMethod(instance, method)) {\n    return () => {};\n  }\n\n  const { add, remove } = service();\n  add(instance.$id, (...args) => {\n    call(instance, method, ...args);\n  });\n\n  return () => remove(instance.$id);\n}\n\n/**\n * Page lifecycle class\n *\n * @method mounted   Fired when the class is instantiated\n * @method loaded    Fired on the window's load event\n * @method ticked    Fired each frame with `requestAnimationFrame`\n * @method resized   Fired when the window is resized (`resize` event)\n * @method moved     Fired when the pointer has moved (`touchmove` and `mousemove` events)\n * @method scrolled  Fired with debounce when the document is scrolled (`scroll` event)\n * @method destroyed Fired when the window is being unloaded (`unload` event)\n */\nexport default class Base extends EventManager {\n  /**\n   * Get the component's refs.\n   * @return {Object}\n   */\n  get $refs() {\n    return getRefs(this, this.$el);\n  }\n\n  /**\n   * Get the component's children components.\n   * @return {Object}\n   */\n  get $children() {\n    return getChildren(this, this.$el, this.config.components || {});\n  }\n\n  /**\n   * Get the component's merged config and options.\n   * @return {Object}\n   */\n  get $options() {\n    return getOptions(this, this.$el, this.config);\n  }\n\n  /**\n   * Set the components option.\n   * @param  {Object} value The new options values to merge with the old ones.\n   * @return {void}\n   */\n  set $options(newOptions) {\n    setOptions(this, this.$el, newOptions);\n  }\n\n  /**\n   * Class constructor where all the magic takes place\n   * @param  {Object}    options An option object\n   * @return {Base}         The mounted instance\n   */\n  constructor(element) {\n    super();\n\n    if (!this.config) {\n      throw new Error('The `config` getter must be defined.');\n    }\n\n    if (!this.config.name) {\n      throw new Error('The `config.name` property is required.');\n    }\n\n    if (!element) {\n      throw new Error('The root element must be defined.');\n    }\n\n    // eslint-disable-next-line\n    Object.defineProperties(this, {\n      $id: {\n        value: `${this.config.name}-${nanoid()}`,\n      },\n      $isMounted: {\n        value: false,\n        writable: true,\n      },\n      $el: {\n        value: element,\n      },\n    });\n\n    debug(this, 'constructor', this);\n\n    let unbindMethods = [];\n\n    // Bind all the methods when the component is mounted,\n    // we save the unbind methods to unbind them all when\n    // the component is destroyed.\n    this.$on('mounted', () => {\n      unbindMethods = [];\n      // Fire the `loaded` method on window load\n      if (hasMethod(this, 'loaded')) {\n        const loadedHandler = event => {\n          call(this, 'loaded', { event });\n        };\n        window.addEventListener('load', loadedHandler);\n        unbindMethods.push(() => {\n          window.removeEventListener('load', loadedHandler);\n        });\n      }\n\n      // Fire the `scrolled` method on window/document scroll\n      unbindMethods = [\n        ...unbindMethods,\n        initService(this, 'scrolled', useScroll),\n        initService(this, 'resized', useResize),\n        initService(this, 'ticked', useRaf),\n        initService(this, 'moved', usePointer),\n        initService(this, 'keyed', useKey),\n      ];\n\n      // Bind method to events on refs\n      let eventMethods = getAllProperties(this).filter(([name]) => name.startsWith('on'));\n\n      Object.entries(this.$refs).forEach(([refName, $refOrRefs]) => {\n        const $refs = Array.isArray($refOrRefs) ? $refOrRefs : [$refOrRefs];\n        const refEventMethod = `on${refName.replace(/^\\w/, c => c.toUpperCase())}`;\n\n        eventMethods\n          .filter(([eventMethod]) => eventMethod.startsWith(refEventMethod))\n          .forEach(([eventMethod]) => {\n            $refs.forEach(($ref, index) => {\n              const eventName = eventMethod.replace(refEventMethod, '').toLowerCase();\n              const handler = event => {\n                debug(this, eventMethod, $ref, event, index);\n                this[eventMethod](event, index);\n              };\n              $ref.addEventListener(eventName, handler);\n\n              unbindMethods.push(() => {\n                $ref.removeEventListener(eventName, handler);\n              });\n            });\n          });\n\n        eventMethods = eventMethods.filter(\n          ([eventMethod]) => !eventMethod.startsWith(refEventMethod)\n        );\n      });\n\n      eventMethods.forEach(([eventMethod]) => {\n        const eventName = eventMethod.replace(/^on/, '').toLowerCase();\n        const handler = event => {\n          debug(this, eventMethod, this.$el, event);\n          this[eventMethod](event);\n        };\n        this.$el.addEventListener(eventName, handler);\n        unbindMethods.push(() => {\n          this.$el.removeEventListener(eventName, handler);\n        });\n      });\n\n      mountComponents(this);\n      this.$isMounted = true;\n    });\n\n    this.$on('destroyed', () => {\n      this.$isMounted = false;\n      unbindMethods.forEach(method => method());\n      destroyComponents(this);\n    });\n\n    if (!this.$el.__base__) {\n      // Attach the instance to the root element\n      Object.defineProperty(this.$el, '__base__', {\n        get: () => this,\n      });\n    }\n\n    // Autobind all methods to the instance\n    autoBind(this, {\n      exclude: [\n        '$mount',\n        '$destroy',\n        '$log',\n        '$on',\n        '$once',\n        '$off',\n        '$emit',\n        'mounted',\n        'loaded',\n        'ticked',\n        'resized',\n        'moved',\n        'keyed',\n        'scrolled',\n        'destroyed',\n      ],\n    });\n\n    // Mount class which are not used as another component's child.\n    if (!this.__isChild__) {\n      this.$mount();\n      Object.defineProperty(this, '$parent', { get: () => null });\n    }\n\n    return this;\n  }\n\n  /**\n   * Small helper to log stuff.\n   *\n   * @param  {...any} args The arguments passed to the method\n   * @return {void}\n   */\n  $log(...args) {\n    return this.$options.log\n      ? window.console.log.apply(window, [this.config.name, ...args])\n      : () => {};\n  }\n\n  /**\n   * Trigger the `mounted` callback.\n   */\n  $mount() {\n    debug(this, '$mount');\n    call(this, 'mounted');\n    return this;\n  }\n\n  /**\n   * Trigger the `destroyed` callback.\n   */\n  $destroy() {\n    debug(this, '$destroy');\n    call(this, 'destroyed');\n    return this;\n  }\n}\n\nBase.__isBase__ = true;\n"],"file":"Base.js"}