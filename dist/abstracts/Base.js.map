{"version":3,"sources":["../../src/abstracts/Base.js"],"names":["debug","instance","args","$options","window","console","log","apply","config","name","getRefs","element","elements","Array","from","querySelectorAll","length","reduce","$refs","$ref","refName","dataset","ref","replace","$realRef","__base__","isArray","push","getChildren","components","Object","entries","acc","ComponentClass","selector","map","el","__isBase__","asyncComponent","then","module","ResolvedClass","default","__isAsync__","call","method","$isMounted","$emit","mountComponent","component","$mount","mountComponents","$children","values","forEach","$child","destroyComponent","$destroy","destroyComponents","initService","service","add","remove","$id","Base","Error","$el","options","JSON","parse","err","defineProperty","get","unbindMethods","$on","loadedHandler","event","addEventListener","removeEventListener","useScroll","useResize","useRaf","usePointer","useKey","requestAnimationFrame","EventManager"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;AAEA;;;;;AAKA,SAASA,KAAT,CAAeC,QAAf,EAAkC;AAAA,oCAANC,IAAM;AAANA,IAAAA,IAAM;AAAA;;AAChC,SAAOD,QAAQ,CAACE,QAAT,CAAkBH,KAAlB,GACHI,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmBC,KAAnB,CAAyBH,MAAzB,GAAkCH,QAAQ,CAACO,MAAT,CAAgBC,IAAlD,SAA2DP,IAA3D,EADG,GAEH,YAAM,CAAE,CAFZ;AAGD;AAED;;;;;;;;;AAOA,SAASQ,OAAT,CAAiBC,OAAjB,EAA0BF,IAA1B,EAAgC;AAC9B,MAAMG,QAAQ,GAAGC,KAAK,CAACC,IAAN,CAAWH,OAAO,CAACI,gBAAR,wBAAwCN,IAAxC,UAAX,CAAjB;;AAEA,MAAIG,QAAQ,CAACI,MAAT,KAAoB,CAAxB,EAA2B;AACzB,WAAO,EAAP;AACD;;AAED,SAAOJ,QAAQ,CAACK,MAAT,CAAgB,UAACC,KAAD,EAAQC,IAAR,EAAiB;AACtC,QAAMC,OAAO,GAAGD,IAAI,CAACE,OAAL,CAAaC,GAAb,CAAiBC,OAAjB,WAA4Bd,IAA5B,QAAqC,EAArC,CAAhB;AACA,QAAMe,QAAQ,GAAGL,IAAI,CAACM,QAAL,GAAgBN,IAAI,CAACM,QAArB,GAAgCN,IAAjD;;AAEA,QAAID,KAAK,CAACE,OAAD,CAAT,EAAoB;AAClB,UAAIP,KAAK,CAACa,OAAN,CAAcR,KAAK,CAACE,OAAD,CAAnB,CAAJ,EAAmC;AACjCF,QAAAA,KAAK,CAACE,OAAD,CAAL,CAAeO,IAAf,CAAoBH,QAApB;AACD,OAFD,MAEO;AACLN,QAAAA,KAAK,CAACE,OAAD,CAAL,GAAiB,CAACF,KAAK,CAACE,OAAD,CAAN,EAAiBI,QAAjB,CAAjB;AACD;AACF,KAND,MAMO;AACLN,MAAAA,KAAK,CAACE,OAAD,CAAL,GAAiBI,QAAjB;AACD;;AAED,WAAON,KAAP;AACD,GAfM,EAeJ,EAfI,CAAP;AAgBD;AAED;;;;;;;;AAMA,SAASU,WAAT,CAAqBjB,OAArB,EAA8BkB,UAA9B,EAA0C;AACxC,MAAI,CAACA,UAAL,EAAiB;AACf,WAAO,EAAP;AACD;;AAED,SAAOC,MAAM,CAACC,OAAP,CAAeF,UAAf,EAA2BZ,MAA3B,CAAkC,UAACe,GAAD,QAAiC;AAAA;AAAA,QAA1BvB,IAA0B;AAAA,QAApBwB,cAAoB;;AACxE,QAAMC,QAAQ,+BAAuBzB,IAAvB,QAAd;AACA,QAAMG,QAAQ,GAAGC,KAAK,CAACC,IAAN,CAAWH,OAAO,CAACI,gBAAR,CAAyBmB,QAAzB,CAAX,CAAjB;;AAEA,QAAItB,QAAQ,CAACI,MAAT,KAAoB,CAAxB,EAA2B;AACzB,aAAOgB,GAAP;AACD;;AAEDA,IAAAA,GAAG,CAACvB,IAAD,CAAH,GAAYG,QAAQ,CAACuB,GAAT,CAAa,UAAAC,EAAE,EAAI;AAC7B;AACA,UAAIA,EAAE,CAACX,QAAP,EAAiB;AACf,eAAOW,EAAE,CAACX,QAAV;AACD,OAJ4B,CAM7B;;;AACA,UAAIQ,cAAc,CAACI,UAAnB,EAA+B;AAC7B,eAAO,IAAIJ,cAAJ,CAAmBG,EAAnB,CAAP;AACD,OAT4B,CAW7B;;;AACA,UAAME,cAAc,GAAGL,cAAc,GAAGM,IAAjB,CAAsB,UAAAC,MAAM,EAAI;AACrD,YAAMC,aAAa,GAAGD,MAAM,CAACE,OAA7B;AACA,eAAO,IAAID,aAAJ,CAAkBL,EAAlB,CAAP;AACD,OAHsB,CAAvB;AAKAE,MAAAA,cAAc,CAACK,WAAf,GAA6B,IAA7B;AAEA,aAAOL,cAAP;AACD,KApBW,CAAZ;AAsBA,WAAON,GAAP;AACD,GA/BM,EA+BJ,EA/BI,CAAP;AAgCD;AAED;;;;;;;;AAMA,SAASY,IAAT,CAAc3C,QAAd,EAAwB4C,MAAxB,EAAyC;AAAA;;AAAA,qCAAN3C,IAAM;AAANA,IAAAA,IAAM;AAAA;;AACvCF,EAAAA,KAAK,MAAL,UAAMC,QAAN,EAAgB,MAAhB,EAAwB4C,MAAxB,SAAmC3C,IAAnC,GADuC,CAGvC;AACA;;AACA,MACG2C,MAAM,KAAK,WAAX,IAA0B,CAAC5C,QAAQ,CAAC6C,UAArC,IACCD,MAAM,KAAK,SAAX,IAAwB5C,QAAQ,CAAC6C,UAFpC,EAGE;AACA9C,IAAAA,KAAK,CAACC,QAAD,EAAW,KAAX,EAAkB4C,MAAlB,EAA0B,qDAA1B,CAAL;AACA,WAAO5C,QAAP;AACD;;AAEDA,EAAAA,QAAQ,CAAC8C,KAAT,OAAA9C,QAAQ,GAAO4C,MAAP,SAAkB3C,IAAlB,EAAR,CAbuC,CAevC;;AACA,MAAI,CAAC,wBAAUD,QAAV,EAAoB4C,MAApB,CAAL,EAAkC;AAChC,WAAO5C,QAAP;AACD;;AAED,sBAAAA,QAAQ,CAAC4C,MAAD,CAAR,EAAiBD,IAAjB,0BAAsB3C,QAAtB,SAAmCC,IAAnC;;AACAF,EAAAA,KAAK,MAAL,UAAMC,QAAN,EAAgB4C,MAAhB,EAAwB5C,QAAxB,SAAqCC,IAArC;AAEA,SAAOD,QAAP;AACD;AAED;;;;;;;;AAMA,SAAS+C,cAAT,CAAwBC,SAAxB,EAAmC;AACjC,MAAIA,SAAS,CAACN,WAAd,EAA2B;AACzBM,IAAAA,SAAS,CAACV,IAAV,CAAe,UAAAtC,QAAQ;AAAA,aAAIA,QAAQ,CAACiD,MAAT,EAAJ;AAAA,KAAvB;AACD,GAFD,MAEO;AACLD,IAAAA,SAAS,CAACC,MAAV;AACD;AACF;AAED;;;;;AAGA,SAASC,eAAT,CAAyBlD,QAAzB,EAAmC;AACjC,MAAI,CAACA,QAAQ,CAACmD,SAAd,EAAyB;AACvB;AACD;;AAEDpD,EAAAA,KAAK,CAACC,QAAD,EAAW,iBAAX,EAA8BA,QAAQ,CAACmD,SAAvC,CAAL;AAEAtB,EAAAA,MAAM,CAACuB,MAAP,CAAcpD,QAAQ,CAACmD,SAAvB,EAAkCE,OAAlC,CAA0C,UAAAC,MAAM,EAAI;AAClD,QAAI1C,KAAK,CAACa,OAAN,CAAc6B,MAAd,CAAJ,EAA2B;AACzBA,MAAAA,MAAM,CAACD,OAAP,CAAeN,cAAf;AACD,KAFD,MAEO;AACLA,MAAAA,cAAc,CAACO,MAAD,CAAd;AACD;AACF,GAND;AAOD;AAED;;;;;;;;AAMA,SAASC,gBAAT,CAA0BP,SAA1B,EAAqC;AACnC,MAAIA,SAAS,CAACN,WAAd,EAA2B;AACzBM,IAAAA,SAAS,CAACV,IAAV,CAAe,UAAAtC,QAAQ;AAAA,aAAIA,QAAQ,CAACwD,QAAT,EAAJ;AAAA,KAAvB;AACD,GAFD,MAEO;AACLR,IAAAA,SAAS,CAACQ,QAAV;AACD;AACF;AAED;;;;;;;;AAMA,SAASC,iBAAT,CAA2BzD,QAA3B,EAAqC;AACnC,MAAI,CAACA,QAAQ,CAACmD,SAAd,EAAyB;AACvB;AACD;;AACDpD,EAAAA,KAAK,CAACC,QAAD,EAAW,mBAAX,EAAgCA,QAAQ,CAACmD,SAAzC,CAAL;AAEAtB,EAAAA,MAAM,CAACuB,MAAP,CAAcpD,QAAQ,CAACmD,SAAvB,EAAkCE,OAAlC,CAA0C,UAAAC,MAAM,EAAI;AAClD,QAAI1C,KAAK,CAACa,OAAN,CAAc6B,MAAd,CAAJ,EAA2B;AACzBA,MAAAA,MAAM,CAACD,OAAP,CAAeE,gBAAf;AACD,KAFD,MAEO;AACLA,MAAAA,gBAAgB,CAACD,MAAD,CAAhB;AACD;AACF,GAND;AAOD;AAED;;;;;;;;;;AAQA,SAASI,WAAT,CAAqB1D,QAArB,EAA+B4C,MAA/B,EAAuCe,OAAvC,EAAgD;AAC9C,MAAI,CAAC,wBAAU3D,QAAV,EAAoB4C,MAApB,CAAL,EAAkC;AAChC,WAAO,YAAM,CAAE,CAAf;AACD;;AAH6C,iBAKtBe,OAAO,EALe;AAAA,MAKtCC,GALsC,YAKtCA,GALsC;AAAA,MAKjCC,MALiC,YAKjCA,MALiC;;AAM9CD,EAAAA,GAAG,CAAC5D,QAAQ,CAAC8D,GAAV,EAAe,YAAa;AAAA,uCAAT7D,IAAS;AAATA,MAAAA,IAAS;AAAA;;AAC7B0C,IAAAA,IAAI,MAAJ,UAAK3C,QAAL,EAAe4C,MAAf,SAA0B3C,IAA1B;AACD,GAFE,CAAH;AAIA,SAAO;AAAA,WAAM4D,MAAM,CAAC7D,QAAQ,CAAC8D,GAAV,CAAZ;AAAA,GAAP;AACD;AAED;;;;;;;;;;;;;IAWqBC,I;;;;;AACnB;;;;;AAKA,gBAAYrD,OAAZ,EAAqB;AAAA;;AAAA;AACnB;;AAEA,QAAI,CAAC,MAAKH,MAAV,EAAkB;AAChB,YAAM,IAAIyD,KAAJ,CAAU,sCAAV,CAAN;AACD;;AAED,QAAI,CAAC,MAAKzD,MAAL,CAAYC,IAAjB,EAAuB;AACrB,YAAM,IAAIwD,KAAJ,CAAU,yCAAV,CAAN;AACD;;AAED,UAAKnB,UAAL,GAAkB,KAAlB;AACA,UAAKiB,GAAL,aAAc,MAAKvD,MAAL,CAAYC,IAA1B,cAAkC,yBAAlC;AACA,UAAKyD,GAAL,GAAWvD,OAAX;;AAEA,QAAI,CAAC,MAAKuD,GAAV,EAAe;AACb,YAAM,IAAID,KAAJ,CAAU,kCAAV,CAAN;AACD;;AAED,QAAIE,OAAO,GAAG,EAAd;;AACA,QAAI,MAAKD,GAAL,CAAS7C,OAAT,CAAiB8C,OAArB,EAA8B;AAC5B,UAAI;AACFA,QAAAA,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAW,MAAKH,GAAL,CAAS7C,OAAT,CAAiB8C,OAA5B,CAAV;AACD,OAFD,CAEE,OAAOG,GAAP,EAAY;AACZ,cAAM,IAAIL,KAAJ,CAAU,wEAAV,CAAN;AACD;AACF;;AAED,UAAK9D,QAAL,mCAAqB,MAAKK,MAA1B,GAAsC2D,OAAO,IAAI,EAAjD;AAEAnE,IAAAA,KAAK,8CAAO,aAAP,8CAAL;AAEA8B,IAAAA,MAAM,CAACyC,cAAP,8CAA4B,OAA5B,EAAqC;AACnCC,MAAAA,GADmC,iBAC7B;AACJ,eAAO9D,OAAO,CAAC,KAAKwD,GAAN,EAAW,KAAK1D,MAAL,CAAYC,IAAvB,CAAd;AACD;AAHkC,KAArC;AAMAqB,IAAAA,MAAM,CAACyC,cAAP,8CAA4B,WAA5B,EAAyC;AACvCC,MAAAA,GADuC,iBACjC;AACJ,eAAO5C,WAAW,CAAC,KAAKsC,GAAN,EAAW,KAAK1D,MAAL,CAAYqB,UAAvB,CAAlB;AACD;AAHsC,KAAzC;AAMA,QAAI4C,aAAa,GAAG,EAApB,CA5CmB,CA8CnB;AACA;AACA;;AACA,UAAKC,GAAL,CAAS,SAAT,EAAoB,YAAM;AACxBD,MAAAA,aAAa,GAAG,EAAhB,CADwB,CAExB;;AACA,UAAI,qEAAgB,QAAhB,CAAJ,EAA+B;AAC7B,YAAME,aAAa,GAAG,SAAhBA,aAAgB,CAAAC,KAAK,EAAI;AAC7BhC,UAAAA,IAAI,8CAAO,QAAP,EAAiB;AAAEgC,YAAAA,KAAK,EAALA;AAAF,WAAjB,CAAJ;AACD,SAFD;;AAGAxE,QAAAA,MAAM,CAACyE,gBAAP,CAAwB,MAAxB,EAAgCF,aAAhC;AACAF,QAAAA,aAAa,CAAC9C,IAAd,CAAmB,YAAM;AACvBvB,UAAAA,MAAM,CAAC0E,mBAAP,CAA2B,MAA3B,EAAmCH,aAAnC;AACD,SAFD;AAGD,OAXuB,CAaxB;;;AACAF,MAAAA,aAAa,8CACRA,aADQ,IAEXd,WAAW,8CAAO,UAAP,EAAmBoB,eAAnB,CAFA,EAGXpB,WAAW,8CAAO,SAAP,EAAkBqB,eAAlB,CAHA,EAIXrB,WAAW,8CAAO,QAAP,EAAiBsB,YAAjB,CAJA,EAKXtB,WAAW,8CAAO,OAAP,EAAgBuB,gBAAhB,CALA,EAMXvB,WAAW,8CAAO,OAAP,EAAgBwB,aAAhB,CANA,EAAb;AASAhC,MAAAA,eAAe,6CAAf;AACA,YAAKL,UAAL,GAAkB,IAAlB;AACD,KAzBD;;AA2BA,UAAK4B,GAAL,CAAS,WAAT,EAAsB,YAAM;AAC1B,YAAK5B,UAAL,GAAkB,KAAlB;AACA2B,MAAAA,aAAa,CAACnB,OAAd,CAAsB,UAAAT,MAAM;AAAA,eAAIA,MAAM,EAAV;AAAA,OAA5B;AACAa,MAAAA,iBAAiB,6CAAjB;AACD,KAJD,EA5EmB,CAkFnB;;;AACA,UAAKQ,GAAL,CAASzC,QAAT,+CAnFmB,CAqFnB;;AACA,wEAtFmB,CAwFnB;AACA;;AACA2D,IAAAA,qBAAqB,CAAC,YAAM;AAC1B,YAAKlC,MAAL;AACD,KAFoB,CAArB;AAIA;AACD;AAED;;;;;;;;;;2BAMc;AAAA,yCAANhD,IAAM;AAANA,QAAAA,IAAM;AAAA;;AACZ,aAAO,KAAKC,QAAL,CAAcG,GAAd,GACHF,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmBC,KAAnB,CAAyBH,MAAzB,GAAkC,KAAKI,MAAL,CAAYC,IAA9C,SAAuDP,IAAvD,EADG,GAEH,YAAM,CAAE,CAFZ;AAGD;AAED;;;;;;6BAGS;AACPF,MAAAA,KAAK,CAAC,IAAD,EAAO,QAAP,CAAL;AACA4C,MAAAA,IAAI,CAAC,IAAD,EAAO,SAAP,CAAJ;AACA,aAAO,IAAP;AACD;AAED;;;;;;+BAGW;AACT5C,MAAAA,KAAK,CAAC,IAAD,EAAO,UAAP,CAAL;AACA4C,MAAAA,IAAI,CAAC,IAAD,EAAO,WAAP,CAAJ;AACA,aAAO,IAAP;AACD;;;EAnI+ByC,sB;;;AAsIlCrB,IAAI,CAAC3B,UAAL,GAAkB,IAAlB","sourcesContent":["/* eslint-disable no-underscore-dangle */\nimport nanoid from 'nanoid/non-secure';\nimport autoBind from 'auto-bind';\nimport EventManager from './EventManager';\nimport hasMethod from '../utils/hasMethod';\nimport usePointer from '../services/pointer';\nimport useRaf from '../services/raf';\nimport useResize from '../services/resize';\nimport useScroll from '../services/scroll';\nimport useKey from '../services/key';\n\n/**\n * Verbose debug for the component.\n * @param  {...any} args The arguments passed to the method\n * @return {void}\n */\nfunction debug(instance, ...args) {\n  return instance.$options.debug\n    ? window.console.log.apply(window, [instance.config.name, ...args])\n    : () => {};\n}\n\n/**\n * Get all refs of a component.\n *\n * @param {HTMLElement}  element The component's root element\n * @param {String}       name    The component's name\n * @return {null|Object}         Returns `null` if no refs were found or an object of references\n */\nfunction getRefs(element, name) {\n  const elements = Array.from(element.querySelectorAll(`[data-ref^=\"${name}.\"]`));\n\n  if (elements.length === 0) {\n    return {};\n  }\n\n  return elements.reduce(($refs, $ref) => {\n    const refName = $ref.dataset.ref.replace(`${name}.`, '');\n    const $realRef = $ref.__base__ ? $ref.__base__ : $ref;\n\n    if ($refs[refName]) {\n      if (Array.isArray($refs[refName])) {\n        $refs[refName].push($realRef);\n      } else {\n        $refs[refName] = [$refs[refName], $realRef];\n      }\n    } else {\n      $refs[refName] = $realRef;\n    }\n\n    return $refs;\n  }, {});\n}\n\n/**\n *\n * @param  {HTMLElement} element    The component's root element\n * @param  {Object}      components The children components' classes\n * @return {null|Object}            Returns `null` if no child components are defined or an object of all child component instances\n */\nfunction getChildren(element, components) {\n  if (!components) {\n    return {};\n  }\n\n  return Object.entries(components).reduce((acc, [name, ComponentClass]) => {\n    const selector = `[data-component=\"${name}\"]`;\n    const elements = Array.from(element.querySelectorAll(selector));\n\n    if (elements.length === 0) {\n      return acc;\n    }\n\n    acc[name] = elements.map(el => {\n      // Return existing instance if it exists\n      if (el.__base__) {\n        return el.__base__;\n      }\n\n      // Return a new instance if the component class is a child of the Base class\n      if (ComponentClass.__isBase__) {\n        return new ComponentClass(el);\n      }\n\n      // Resolve async components\n      const asyncComponent = ComponentClass().then(module => {\n        const ResolvedClass = module.default;\n        return new ResolvedClass(el);\n      });\n\n      asyncComponent.__isAsync__ = true;\n\n      return asyncComponent;\n    });\n\n    return acc;\n  }, {});\n}\n\n/**\n * Call the given method while applying the given arguments.\n *\n * @param {String} method The method to call\n * @param {...any} args   The arguments to pass to the method\n */\nfunction call(instance, method, ...args) {\n  debug(instance, 'call', method, ...args);\n\n  // Prevent duplicate call of `mounted` and `destroyed`\n  // methods based on the component status\n  if (\n    (method === 'destroyed' && !instance.$isMounted) ||\n    (method === 'mounted' && instance.$isMounted)\n  ) {\n    debug(instance, 'not', method, 'because the method has already been triggered once.');\n    return instance;\n  }\n\n  instance.$emit(method, ...args);\n\n  // We always emit an event, but we do not call the method if it does not exist\n  if (!hasMethod(instance, method)) {\n    return instance;\n  }\n\n  instance[method].call(instance, ...args);\n  debug(instance, method, instance, ...args);\n\n  return instance;\n}\n\n/**\n * Mount a given component which might be async.\n *\n * @param  {Base|Promise} component The component to mount.\n * @return {void}\n */\nfunction mountComponent(component) {\n  if (component.__isAsync__) {\n    component.then(instance => instance.$mount());\n  } else {\n    component.$mount();\n  }\n}\n\n/**\n * Tie the components' `mounted` method to the instance\n */\nfunction mountComponents(instance) {\n  if (!instance.$children) {\n    return;\n  }\n\n  debug(instance, 'mountComponents', instance.$children);\n\n  Object.values(instance.$children).forEach($child => {\n    if (Array.isArray($child)) {\n      $child.forEach(mountComponent);\n    } else {\n      mountComponent($child);\n    }\n  });\n}\n\n/**\n * Destroy a given component which might be async.\n *\n * @param  {Base|Promise} component The component to destroy.\n * @return {void}\n */\nfunction destroyComponent(component) {\n  if (component.__isAsync__) {\n    component.then(instance => instance.$destroy());\n  } else {\n    component.$destroy();\n  }\n}\n\n/**\n * Tie the components' `destroyed` method to the instance.\n *\n * @param  {Base} instance The base instance.\n * @return {void}\n */\nfunction destroyComponents(instance) {\n  if (!instance.$children) {\n    return;\n  }\n  debug(instance, 'destroyComponents', instance.$children);\n\n  Object.values(instance.$children).forEach($child => {\n    if (Array.isArray($child)) {\n      $child.forEach(destroyComponent);\n    } else {\n      destroyComponent($child);\n    }\n  });\n}\n\n/**\n * Init the given service and bind it to the given instance.\n *\n * @param  {Base}     instance The Base instance.\n * @param  {String}   method   The instance to test for binding\n * @param  {Function} service  The service `use...` function\n * @return {Function}          A function to unbind the service\n */\nfunction initService(instance, method, service) {\n  if (!hasMethod(instance, method)) {\n    return () => {};\n  }\n\n  const { add, remove } = service();\n  add(instance.$id, (...args) => {\n    call(instance, method, ...args);\n  });\n\n  return () => remove(instance.$id);\n}\n\n/**\n * Page lifecycle class\n *\n * @method mounted   Fired when the class is instantiated\n * @method loaded    Fired on the window's load event\n * @method ticked    Fired each frame with `requestAnimationFrame`\n * @method resized   Fired when the window is resized (`resize` event)\n * @method moved     Fired when the pointer has moved (`touchmove` and `mousemove` events)\n * @method scrolled  Fired with debounce when the document is scrolled (`scroll` event)\n * @method destroyed Fired when the window is being unloaded (`unload` event)\n */\nexport default class Base extends EventManager {\n  /**\n   * Class constructor where all the magic takes place\n   * @param  {Object}    options An option object\n   * @return {Base}         The mounted instance\n   */\n  constructor(element) {\n    super();\n\n    if (!this.config) {\n      throw new Error('The `config` getter must be defined.');\n    }\n\n    if (!this.config.name) {\n      throw new Error('The `config.name` property is required.');\n    }\n\n    this.$isMounted = false;\n    this.$id = `${this.config.name}-${nanoid()}`;\n    this.$el = element;\n\n    if (!this.$el) {\n      throw new Error('Unable to find the root element.');\n    }\n\n    let options = {};\n    if (this.$el.dataset.options) {\n      try {\n        options = JSON.parse(this.$el.dataset.options);\n      } catch (err) {\n        throw new Error('Can not parse the `data-options` attribute. Is it a valid JSON string?');\n      }\n    }\n\n    this.$options = { ...this.config, ...(options || {}) };\n\n    debug(this, 'constructor', this);\n\n    Object.defineProperty(this, '$refs', {\n      get() {\n        return getRefs(this.$el, this.config.name);\n      },\n    });\n\n    Object.defineProperty(this, '$children', {\n      get() {\n        return getChildren(this.$el, this.config.components);\n      },\n    });\n\n    let unbindMethods = [];\n\n    // Bind all the methods when the component is mounted,\n    // we save the unbind methods to unbind them all when\n    // the component is destroyed.\n    this.$on('mounted', () => {\n      unbindMethods = [];\n      // Fire the `loaded` method on window load\n      if (hasMethod(this, 'loaded')) {\n        const loadedHandler = event => {\n          call(this, 'loaded', { event });\n        };\n        window.addEventListener('load', loadedHandler);\n        unbindMethods.push(() => {\n          window.removeEventListener('load', loadedHandler);\n        });\n      }\n\n      // Fire the `scrolled` method on window/document scroll\n      unbindMethods = [\n        ...unbindMethods,\n        initService(this, 'scrolled', useScroll),\n        initService(this, 'resized', useResize),\n        initService(this, 'ticked', useRaf),\n        initService(this, 'moved', usePointer),\n        initService(this, 'keyed', useKey),\n      ];\n\n      mountComponents(this);\n      this.$isMounted = true;\n    });\n\n    this.$on('destroyed', () => {\n      this.$isMounted = false;\n      unbindMethods.forEach(method => method());\n      destroyComponents(this);\n    });\n\n    // Attach the instance to the root element\n    this.$el.__base__ = this;\n\n    // Autobind all methods to the instance\n    autoBind(this);\n\n    // Fire the `mounted` method on the next frame so the class\n    // properties are correctly loaded\n    requestAnimationFrame(() => {\n      this.$mount();\n    });\n\n    return this;\n  }\n\n  /**\n   * Small helper to log stuff.\n   *\n   * @param  {...any} args The arguments passed to the method\n   * @return {void}\n   */\n  $log(...args) {\n    return this.$options.log\n      ? window.console.log.apply(window, [this.config.name, ...args])\n      : () => {};\n  }\n\n  /**\n   * Trigger the `mounted` callback.\n   */\n  $mount() {\n    debug(this, '$mount');\n    call(this, 'mounted');\n    return this;\n  }\n\n  /**\n   * Trigger the `destroyed` callback.\n   */\n  $destroy() {\n    debug(this, '$destroy');\n    call(this, 'destroyed');\n    return this;\n  }\n}\n\nBase.__isBase__ = true;\n"],"file":"Base.js"}