{"version":3,"sources":["../../src/components/Modal.js"],"names":["trap","untrap","saveActiveElement","setClasses","element","classNames","method","split","forEach","className","classList","setStyles","styles","Object","entries","prop","value","style","Modal","isOpen","open","Array","isArray","$refs","btn","addEventListener","close","overlay","$options","move","target","document","querySelector","body","appendChild","modal","removeEventListener","event","isUp","isDown","ESC","setAttribute","documentElement","overflow","openClass","ref","classes","openStyle","closedClass","closedStyle","autofocus","focus","$emit","name","opacity","pointerEvents","visibility","Base"],"mappings":"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","sourcesContent":["import Base from '../abstracts/Base';\nimport isObject from '../utils/isObject';\nimport tabTrap from '../utils/tabTrap';\n\nconst { trap, untrap, saveActiveElement } = tabTrap();\n\n/**\n * Manage a list of classes as string on an element.\n *\n * @param {HTMLElement} element    The element to update.\n * @param {String}      classNames A string of class names.\n * @param {String}      method     The method to use: add, remove or toggle.\n */\nfunction setClasses(element, classNames, method = 'add') {\n  if (!element || !classNames) {\n    return;\n  }\n\n  classNames.split(' ').forEach(className => {\n    element.classList[method](className);\n  });\n}\n\n/**\n * Manage a list of style properties on an element.\n *\n * @param {HTMLElement}         element The element to update.\n * @param {CSSStyleDeclaration} styles  An object of styles properties and values.\n * @param {String}              method  The method to use: add or remove.\n */\nfunction setStyles(element, styles, method = 'add') {\n  if (!element || !styles || !isObject(styles)) {\n    return;\n  }\n\n  Object.entries(styles).forEach(([prop, value]) => {\n    element.style[prop] = method === 'add' ? value : '';\n  });\n}\n\n/**\n * Modal class.\n */\nexport default class Modal extends Base {\n  /**\n   * Modal options.\n   */\n  get config() {\n    return {\n      name: 'Modal',\n      move: false,\n      autofocus: '[autofocus]',\n      openClass: {},\n      openStyle: {},\n      closedClass: {},\n      closedStyle: {\n        modal: {\n          opacity: 0,\n          pointerEvents: 'none',\n          visibility: 'hidden',\n        },\n      },\n    };\n  }\n\n  /**\n   * Initialize the component's behaviours.\n   *\n   * @return {Modal} The current instance.\n   */\n  mounted() {\n    this.isOpen = false;\n\n    const open = Array.isArray(this.$refs.open) ? this.$refs.open : [this.$refs.open];\n    open.forEach(btn => btn.addEventListener('click', this.open));\n\n    const close = Array.isArray(this.$refs.close) ? this.$refs.close : [this.$refs.close];\n    close.forEach(btn => btn.addEventListener('click', this.close));\n\n    this.$refs.overlay.addEventListener('click', this.close);\n\n    this.close();\n\n    if (this.$options.move) {\n      const target = document.querySelector(this.$options.move) || document.body;\n      target.appendChild(this.$refs.modal);\n    }\n\n    return this;\n  }\n\n  /**\n   * Unbind all events on destroy.\n   *\n   * @return {Modal} The Modal instance.\n   */\n  destroyed() {\n    this.close();\n\n    const open = Array.isArray(this.$refs.open) ? this.$refs.open : [this.$refs.open];\n    open.forEach(btn => btn.removeEventListener('click', this.open));\n\n    const close = Array.isArray(this.$refs.close) ? this.$refs.close : [this.$refs.close];\n    close.forEach(btn => btn.removeEventListener('click', this.close));\n\n    this.$refs.overlay.removeEventListener('click', this.close);\n    return this;\n  }\n\n  /**\n   * Close the modal on `ESC` and trap the tabulation.\n   *\n   * @param  {KeyboardEvent} options.event  The original keyboard event\n   * @param  {Boolean}       options.isUp   Is it a keyup event?\n   * @param  {Boolean}       options.isDown Is it a keydown event?\n   * @param  {Boolean}       options.ESC    Is it the ESC key?\n   * @return {void}\n   */\n  keyed({ event, isUp, isDown, ESC }) {\n    if (!this.isOpen) {\n      return;\n    }\n\n    if (isDown) {\n      trap(this.$refs.modal, event);\n    }\n\n    if (ESC && isUp) {\n      this.close();\n    }\n  }\n\n  /**\n   * Open the modal.\n   *\n   * @return {Modal} The Modal instance.\n   */\n  open() {\n    this.$refs.modal.setAttribute('aria-hidden', 'false');\n    document.documentElement.style.overflow = 'hidden';\n\n    // Add \"open\" classes to refs\n    Object.entries(this.$options.openClass).forEach(([ref, classes]) => {\n      setClasses(this.$refs[ref], classes);\n    });\n\n    // Add \"open\" styles to refs\n    Object.entries(this.$options.openStyle).forEach(([ref, styles]) => {\n      setStyles(this.$refs[ref], styles);\n    });\n\n    // Remove \"closed\" classes from refs\n    Object.entries(this.$options.closedClass).forEach(([ref, classes]) => {\n      setClasses(this.$refs[ref], classes, 'remove');\n    });\n\n    // Remove \"closed\" styles from refs\n    Object.entries(this.$options.closedStyle).forEach(([ref, styles]) => {\n      setStyles(this.$refs[ref], styles, 'remove');\n    });\n\n    if (this.$options.autofocus && this.$refs.modal.querySelector(this.$options.autofocus)) {\n      saveActiveElement();\n      this.$refs.modal.querySelector(this.$options.autofocus).focus();\n    }\n\n    this.isOpen = true;\n    this.$emit('open');\n  }\n\n  /**\n   * Close the modal.\n   *\n   * @return {Modal} The Modal instance.\n   */\n  close() {\n    this.$refs.modal.setAttribute('aria-hidden', 'true');\n    document.documentElement.style.overflow = '';\n\n    // Add \"closed\" classes to refs\n    Object.entries(this.$options.closedClass).forEach(([ref, classes]) => {\n      setClasses(this.$refs[ref], classes);\n    });\n\n    // Add \"closed\" styles to refs\n    Object.entries(this.$options.closedStyle).forEach(([ref, styles]) => {\n      setStyles(this.$refs[ref], styles);\n    });\n\n    // Remove \"open\" classes from refs\n    Object.entries(this.$options.openClass).forEach(([ref, classes]) => {\n      setClasses(this.$refs[ref], classes, 'remove');\n    });\n\n    // Remove \"open\" styles from refs\n    Object.entries(this.$options.openStyle).forEach(([ref, styles]) => {\n      setStyles(this.$refs[ref], styles, 'remove');\n    });\n\n    this.isOpen = false;\n    untrap();\n    this.$emit('close');\n  }\n}\n"],"file":"Modal.js"}