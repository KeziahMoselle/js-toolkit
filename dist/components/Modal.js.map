{"version":3,"sources":["../../src/components/Modal.js"],"names":["trap","untrap","saveActiveElement","Modal","isOpen","open","Array","isArray","$refs","forEach","btn","addEventListener","close","overlay","$options","move","target","document","querySelector","body","refsBackup","refModalPlaceholder","createComment","refModalParentBackup","modal","parentElement","$el","insertBefore","refModalUnbindGetRefFilter","$on","refs","Object","entries","key","ref","appendChild","remove","removeEventListener","event","isUp","isDown","ESC","setAttribute","documentElement","style","overflow","openClass","classes","openStyle","styles","closedClass","closedStyle","autofocus","focus","$emit","name","opacity","pointerEvents","visibility","Base"],"mappings":"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","sourcesContent":["import Base from '../abstracts/Base';\nimport setClasses from '../utils/setClasses';\nimport setStyles from '../utils/setStyles';\nimport focusTrap from '../utils/focusTrap';\n\nconst { trap, untrap, saveActiveElement } = focusTrap();\n\n/**\n * Modal class.\n */\nexport default class Modal extends Base {\n  /**\n   * Modal options.\n   */\n  get config() {\n    return {\n      name: 'Modal',\n      move: false,\n      autofocus: '[autofocus]',\n      openClass: {},\n      openStyle: {},\n      closedClass: {},\n      closedStyle: {\n        modal: {\n          opacity: 0,\n          pointerEvents: 'none',\n          visibility: 'hidden',\n        },\n      },\n    };\n  }\n\n  /**\n   * Initialize the component's behaviours.\n   *\n   * @return {Modal} The current instance.\n   */\n  mounted() {\n    this.isOpen = false;\n\n    const open = Array.isArray(this.$refs.open) ? this.$refs.open : [this.$refs.open];\n    open.forEach(btn => btn.addEventListener('click', this.open));\n\n    const close = Array.isArray(this.$refs.close) ? this.$refs.close : [this.$refs.close];\n    close.forEach(btn => btn.addEventListener('click', this.close));\n\n    this.$refs.overlay.addEventListener('click', this.close);\n\n    this.close();\n\n    if (this.$options.move) {\n      const target = document.querySelector(this.$options.move) || document.body;\n      const refsBackup = this.$refs;\n\n      this.refModalPlaceholder = document.createComment('');\n      this.refModalParentBackup = this.$refs.modal.parentElement || this.$el;\n      this.refModalParentBackup.insertBefore(this.refModalPlaceholder, this.$refs.modal);\n\n      this.refModalUnbindGetRefFilter = this.$on('get:refs', refs => {\n        Object.entries(refsBackup).forEach(([key, ref]) => {\n          if (!refs[key]) {\n            refs[key] = ref;\n          }\n        });\n      });\n      target.appendChild(this.$refs.modal);\n    }\n\n    return this;\n  }\n\n  /**\n   * Unbind all events on destroy.\n   *\n   * @return {Modal} The Modal instance.\n   */\n  destroyed() {\n    this.close();\n\n    if (this.$options.move) {\n      this.refModalParentBackup.insertBefore(this.$refs.modal, this.refModalPlaceholder);\n      this.refModalUnbindGetRefFilter();\n      this.refModalPlaceholder.remove();\n      delete this.refModalPlaceholder;\n      delete this.refModalParentBackup;\n      delete this.refModalUnbindGetRefFilter;\n    }\n\n    const open = Array.isArray(this.$refs.open) ? this.$refs.open : [this.$refs.open];\n    open.forEach(btn => btn.removeEventListener('click', this.open));\n\n    const close = Array.isArray(this.$refs.close) ? this.$refs.close : [this.$refs.close];\n    close.forEach(btn => btn.removeEventListener('click', this.close));\n\n    this.$refs.overlay.removeEventListener('click', this.close);\n    return this;\n  }\n\n  /**\n   * Close the modal on `ESC` and trap the tabulation.\n   *\n   * @param  {KeyboardEvent} options.event  The original keyboard event\n   * @param  {Boolean}       options.isUp   Is it a keyup event?\n   * @param  {Boolean}       options.isDown Is it a keydown event?\n   * @param  {Boolean}       options.ESC    Is it the ESC key?\n   * @return {void}\n   */\n  keyed({ event, isUp, isDown, ESC }) {\n    if (!this.isOpen) {\n      return;\n    }\n\n    if (isDown) {\n      trap(this.$refs.modal, event);\n    }\n\n    if (ESC && isUp) {\n      this.close();\n    }\n  }\n\n  /**\n   * Open the modal.\n   *\n   * @return {Modal} The Modal instance.\n   */\n  open() {\n    this.$refs.modal.setAttribute('aria-hidden', 'false');\n    document.documentElement.style.overflow = 'hidden';\n\n    // Add \"open\" classes to refs\n    Object.entries(this.$options.openClass).forEach(([ref, classes]) => {\n      setClasses(this.$refs[ref], classes);\n    });\n\n    // Add \"open\" styles to refs\n    Object.entries(this.$options.openStyle).forEach(([ref, styles]) => {\n      setStyles(this.$refs[ref], styles);\n    });\n\n    // Remove \"closed\" classes from refs\n    Object.entries(this.$options.closedClass).forEach(([ref, classes]) => {\n      setClasses(this.$refs[ref], classes, 'remove');\n    });\n\n    // Remove \"closed\" styles from refs\n    Object.entries(this.$options.closedStyle).forEach(([ref, styles]) => {\n      setStyles(this.$refs[ref], styles, 'remove');\n    });\n\n    if (this.$options.autofocus && this.$refs.modal.querySelector(this.$options.autofocus)) {\n      saveActiveElement();\n      this.$refs.modal.querySelector(this.$options.autofocus).focus();\n    }\n\n    this.isOpen = true;\n    this.$emit('open');\n  }\n\n  /**\n   * Close the modal.\n   *\n   * @return {Modal} The Modal instance.\n   */\n  close() {\n    this.$refs.modal.setAttribute('aria-hidden', 'true');\n    document.documentElement.style.overflow = '';\n\n    // Add \"closed\" classes to refs\n    Object.entries(this.$options.closedClass).forEach(([ref, classes]) => {\n      setClasses(this.$refs[ref], classes);\n    });\n\n    // Add \"closed\" styles to refs\n    Object.entries(this.$options.closedStyle).forEach(([ref, styles]) => {\n      setStyles(this.$refs[ref], styles);\n    });\n\n    // Remove \"open\" classes from refs\n    Object.entries(this.$options.openClass).forEach(([ref, classes]) => {\n      setClasses(this.$refs[ref], classes, 'remove');\n    });\n\n    // Remove \"open\" styles from refs\n    Object.entries(this.$options.openStyle).forEach(([ref, styles]) => {\n      setStyles(this.$refs[ref], styles, 'remove');\n    });\n\n    this.isOpen = false;\n    untrap();\n    this.$emit('close');\n  }\n}\n"],"file":"Modal.js"}